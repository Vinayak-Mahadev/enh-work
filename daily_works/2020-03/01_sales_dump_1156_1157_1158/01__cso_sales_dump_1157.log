Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  8746  Entry pullDataToFile.. Started at --> Sun Mar 01 15:24:51 IST 2020
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  8749  pullDataToFile service received interface id-->[1157]
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  8787  Started pullDataToFile.. 1157  Started at --> Sun Mar 01 15:24:51 IST 2020
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  8888  [dataConverter] class com.sun.proxy.$Proxy209
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.processor.OutletSalesDump [LineNumber]:  75  OutletSalesDump :: Entry processRequest ... InterfaceId : 1157, RequiredDate : null
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  9467  Entry readFilePropertyBeans.. Started at --> Sun Mar 01 15:24:51 IST 2020
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  9481  readFilePropertyBeans service received interface id-->1157
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  10283  Exit readFilePropertyBeans service at -->Sun Mar 01 15:24:51 IST 2020 --- and took 38 milliseconds
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.processor.OutletSalesDump [LineNumber]:  168  Interface : 1157 : File : CSO_Sales_20200301.csv
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  187  Entry getPGCursor..
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"sort-by":{"node_id":1},"connection-id":"snoc-r4","schema-name":"snoc_report","projection":{"operator_name":1,"operator_id":1,"node_id":1},"collection-name":"org_user_node_acc","parameters":[{"param-value":"1031","param-name":"position_id"},{"param-value":174,"param-name":"node_status"}]}
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  215  pgCursors size : 0
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"is-postgres":true,"query":"select cso_org_links.node_id_n as node_id_n, count(distinct(outlet_node_master.org_id_n)) as sso_outlets_n from kpi.tr_daily_serial_injection_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.metrics_id_n in (select metrics_id_n from kpi.ms_metrics_master where ext_metrics_id_v in (select unnest(string_to_array(property_value_v::text, ','::text)::character varying[]) from kpi.ms_property_master where property_key_v ilike 'starter_pack_master')) and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n = daily_event_aggr.source_id_n) inner join kpi.ms_user_org_links as cso_org_links on (cso_org_links.dest_org_id_n = outlet_node_master.org_id_n and cso_org_links.status_n = 174 and 1031 = any(cso_org_links.position_id_n)) group by cso_org_links.node_id_n order by cso_org_links.node_id_n;","map-key":{"local-key":"node_id","type":"Long","key":"node_id_n"},"collection-name":"Collection-2","fields":"sso"}
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  215  pgCursors size : 1
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"is-postgres":true,"query":"select cso_org_links.node_id_n as node_id_n, count(distinct(outlet_org_master.org_id_n)) as sso3_count_n from (select source_id_n as aggregation_id_n, round((sum(dimension_1_n)\/100),0) as injection_qty_n from kpi.tr_daily_serial_injection_aggr where day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and metrics_type_n = 11 and metrics_id_n in (select metrics_id_n from kpi.ms_metrics_master where ext_metrics_id_v in (select unnest(string_to_array(property_value_v::text, ','::text)::character varying[]) from kpi.ms_property_master where property_key_v ilike 'starter_pack_master')) group by aggregation_id_n having round((sum(dimension_1_n)\/100),0) >= (select property_value_n from kpi.ms_property_master where property_key_v = 'stable_sso_injection_qty') ) as daily_event_aggr inner join kpi.ms_report_org_master as outlet_org_master on (outlet_org_master.org_type_n = 6 and outlet_org_master.aggregation_id_n = daily_event_aggr.aggregation_id_n) inner join kpi.ms_user_org_links as cso_org_links on (cso_org_links.dest_org_id_n = outlet_org_master.org_id_n and cso_org_links.status_n = 174 and 1031 = any(cso_org_links.position_id_n)) group by cso_org_links.node_id_n order by cso_org_links.node_id_n;","map-key":{"local-key":"node_id","type":"Long","key":"node_id_n"},"collection-name":"Collection-3","fields":"sso3_count_n"}
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  215  pgCursors size : 2
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"is-postgres":true,"query":"select daily_injection_aggr.entity_id_n as node_id_n, round((sum(daily_injection_aggr.daily_sso_outlets_n)\/(select (now()::date - date_trunc('month', now())::date)::numeric)),0) as daily_sso_n from (select daily_event_aggr.day_id_n as day_id_n, cso_org_links.node_id_n as entity_id_n, count(distinct(outlet_org_master.org_id_n)) daily_sso_outlets_n from kpi.tr_daily_serial_injection_aggr as daily_event_aggr inner join kpi.ms_report_org_master as outlet_org_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.metrics_id_n in (select metrics_id_n from kpi.ms_metrics_master where ext_metrics_id_v in (select unnest(string_to_array(property_value_v::text, ','::text)::character varying[]) from kpi.ms_property_master where property_key_v ilike 'starter_pack_master')) and outlet_org_master.org_type_n = 6 and daily_event_aggr.source_id_n = outlet_org_master.aggregation_id_n) inner join kpi.ms_user_org_links as cso_org_links on (cso_org_links.dest_org_id_n = outlet_org_master.org_id_n and cso_org_links.status_n = 174 and 1031 = any(cso_org_links.position_id_n)) group by day_id_n, entity_id_n ) as daily_injection_aggr group by daily_injection_aggr.entity_id_n order by daily_injection_aggr.entity_id_n;","map-key":{"local-key":"node_id","type":"Long","key":"node_id_n"},"collection-name":"Collection-4","fields":"daily_sso"}
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  215  pgCursors size : 3
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"is-postgres":true,"query":"select cso_org_links.node_id_n as node_id_n, count(distinct(outlet_org_master.org_id_n)) as uro_count_n from (select aggregation_id_n from (select redemption_aggr.source_id_n as aggregation_id_n, sum(redemption_aggr.dimension_2_n) as revenue_value_n from kpi.tr_daily_voucher_redemption_aggr as redemption_aggr where redemption_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and redemption_aggr.metrics_type_n = 11 group by redemption_aggr.source_id_n union select transaction_aggr.actor_id_n as aggregation_id_n, sum(transaction_aggr.dimension_2_n) as revenue_value_n from kpi.tr_daily_mobo_transaction_aggr as transaction_aggr where transaction_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and transaction_aggr.metrics_type_n = 21 and transaction_aggr.source_id_n = 0 and transaction_aggr.instance_type_n = 33 and transaction_aggr.instance_id_n in (select metrics_id_n from kpi.ms_metrics_master where metrics_type_n = 33 and metrics_name_v in ('Purchase Data Package', 'Indosat Reload')) group by transaction_aggr.actor_id_n ) as revenue_aggr group by aggregation_id_n having round((sum(revenue_value_n)\/100),2) >= (select property_value_n from kpi.ms_property_master where property_key_v = 'revenue_transaction_value') ) as monthly_metrics_aggr inner join kpi.ms_report_org_master as outlet_org_master on (outlet_org_master.org_type_n = 6 and outlet_org_master.aggregation_id_n = monthly_metrics_aggr.aggregation_id_n) inner join kpi.ms_user_org_links as cso_org_links on (cso_org_links.dest_org_id_n = outlet_org_master.org_id_n and cso_org_links.status_n = 174 and 1031 = any(cso_org_links.position_id_n)) group by cso_org_links.node_id_n order by cso_org_links.node_id_n;","map-key":{"local-key":"node_id","type":"Long","key":"node_id_n"},"collection-name":"Collection-5","fields":"uro"}
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  215  pgCursors size : 4
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"is-postgres":true,"query":"select cso_org_links.node_id_n as node_id_n, count(distinct(outlet_org_master.org_id_n)) as uro20_count_n from (select aggregation_id_n from (select redemption_aggr.source_id_n as aggregation_id_n, sum(redemption_aggr.dimension_2_n) as revenue_value_n from kpi.tr_daily_voucher_redemption_aggr as redemption_aggr where redemption_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and redemption_aggr.metrics_type_n = 11 group by redemption_aggr.source_id_n union select transaction_aggr.actor_id_n as aggregation_id_n, sum(transaction_aggr.dimension_2_n) as revenue_value_n from kpi.tr_daily_mobo_transaction_aggr as transaction_aggr where transaction_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and transaction_aggr.metrics_type_n = 21 and transaction_aggr.source_id_n = 0 and transaction_aggr.instance_type_n = 33 and transaction_aggr.instance_id_n in (select metrics_id_n from kpi.ms_metrics_master where metrics_type_n = 33 and metrics_name_v in ('Purchase Data Package', 'Indosat Reload')) group by transaction_aggr.actor_id_n ) as revenue_aggr group by revenue_aggr.aggregation_id_n having round((sum(revenue_aggr.revenue_value_n)\/100),2) >= (select property_value_n from kpi.ms_property_master where property_key_v = 'stable_uro_revenue_value') ) as monthly_metrics_aggr inner join kpi.ms_report_org_master as outlet_org_master on (outlet_org_master.org_type_n = 6 and outlet_org_master.aggregation_id_n = monthly_metrics_aggr.aggregation_id_n) inner join kpi.ms_user_org_links as cso_org_links on (cso_org_links.dest_org_id_n = outlet_org_master.org_id_n and cso_org_links.status_n = 174 and 1031 = any(cso_org_links.position_id_n)) group by cso_org_links.node_id_n order by cso_org_links.node_id_n;","map-key":{"local-key":"node_id","type":"Long","key":"node_id_n"},"collection-name":"Collection-6","fields":"uro_20k_plus"}
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  215  pgCursors size : 5
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"is-postgres":true,"query":"select daily_uro_aggr.node_id_n as node_id_n, round((sum(daily_uro_outlets_n)\/(select (now()::date - date_trunc('month', now())::date)::numeric)),0) as daily_uro_n from (select revenue_aggr.day_id_n as day_id_n, cso_org_links.node_id_n as node_id_n, count(distinct(outlet_org_master.org_id_n)) as daily_uro_outlets_n from (select redemption_aggr.day_id_n as day_id_n, redemption_aggr.source_id_n as aggregation_id_n, sum(redemption_aggr.dimension_2_n) as revenue_value_n from kpi.tr_daily_voucher_redemption_aggr as redemption_aggr where redemption_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and redemption_aggr.metrics_type_n = 11 group by redemption_aggr.day_id_n, redemption_aggr.source_id_n union select transaction_aggr.day_id_n as day_id_n, transaction_aggr.actor_id_n as aggregation_id_n, sum(transaction_aggr.dimension_2_n) as revenue_value_n from kpi.tr_daily_mobo_transaction_aggr as transaction_aggr where transaction_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and transaction_aggr.metrics_type_n = 21 and transaction_aggr.source_id_n = 0 and transaction_aggr.instance_type_n = 33 and transaction_aggr.instance_id_n in (select metrics_id_n from kpi.ms_metrics_master where metrics_type_n = 33 and metrics_name_v in ('Purchase Data Package', 'Indosat Reload')) group by transaction_aggr.day_id_n, transaction_aggr.actor_id_n ) as revenue_aggr inner join kpi.ms_report_org_master as outlet_org_master on (outlet_org_master.org_type_n = 6 and outlet_org_master.aggregation_id_n = revenue_aggr.aggregation_id_n) inner join kpi.ms_user_org_links as cso_org_links on (cso_org_links.dest_org_id_n = outlet_org_master.org_id_n and cso_org_links.status_n = 174 and 1031 = any(cso_org_links.position_id_n)) group by day_id_n, node_id_n having round((sum(revenue_value_n)\/100),2) >= (select property_value_n from kpi.ms_property_master where property_key_v = 'revenue_transaction_value') ) as daily_uro_aggr group by daily_uro_aggr.node_id_n order by daily_uro_aggr.node_id_n;","map-key":{"local-key":"node_id","type":"Long","key":"node_id_n"},"collection-name":"Collection-7","fields":"daily_uro"}
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  215  pgCursors size : 6
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"is-postgres":true,"query":"select cso_node_master.node_id_n, sum(mobo_summary_aggr.mobo_high_n) as mobo_sellin_count_n from kpi.tr_mobo_summary_aggr as mobo_summary_aggr inner join kpi.ms_report_node_master as cso_node_master on (mobo_summary_aggr.month_id_n = to_char((date_trunc('month', current_date))::date,'yyyymm')::numeric and cso_node_master.node_id_n = mobo_summary_aggr.node_id_n) group by cso_node_master.node_id_n order by cso_node_master.node_id_n;","map-key":{"local-key":"node_id","type":"Long","key":"node_id_n"},"collection-name":"Collection-8","fields":"mobo_sellin_ge50k"}
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  215  pgCursors size : 7
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"connection-id":"snoc-r5","is-lookup":true,"schema-name":"daily_dump_snapshot","projection":{"region_name":1},"collection-name":"outlet_hierachy_dump","fields":"region,hor_name,area,hos_name,sales_area,sam_name,csm_name,cso_name"}
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  215  pgCursors size : 7
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  237  Exit getPGCursor..
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  256  Entry getMongoCursor..
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  292  configObject : {"sort-by":{"node_id":1},"connection-id":"snoc-r4","schema-name":"snoc_report","projection":{"operator_name":1,"operator_id":1,"node_id":1},"collection-name":"org_user_node_acc","parameters":[{"param-value":"1031","param-name":"position_id"},{"param-value":174,"param-name":"node_status"}]}
Mar 01, 2020 3:24:51 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  366  Query Object : { "position_id" : "1031" , "node_status" : 174}
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  381  SortColumns : [node_id]
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  402  Sort file script is initiated for file :: /home/appuser/snoc/snocconf/interfaceconf/sort/org_user_node_acc_20200301152452145.csv.cp
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  403  Script file : /home/appuser/snoc/snocconf/interfaceconf/sort/collection1.sh
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  405  Process : waitFor() :: 0
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  422  mongoCursors size : 1
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  292  configObject : {"is-postgres":true,"query":"select cso_org_links.node_id_n as node_id_n, count(distinct(outlet_node_master.org_id_n)) as sso_outlets_n from kpi.tr_daily_serial_injection_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.metrics_id_n in (select metrics_id_n from kpi.ms_metrics_master where ext_metrics_id_v in (select unnest(string_to_array(property_value_v::text, ','::text)::character varying[]) from kpi.ms_property_master where property_key_v ilike 'starter_pack_master')) and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n = daily_event_aggr.source_id_n) inner join kpi.ms_user_org_links as cso_org_links on (cso_org_links.dest_org_id_n = outlet_node_master.org_id_n and cso_org_links.status_n = 174 and 1031 = any(cso_org_links.position_id_n)) group by cso_org_links.node_id_n order by cso_org_links.node_id_n;","map-key":{"local-key":"node_id","type":"Long","key":"node_id_n"},"collection-name":"Collection-2","fields":"sso"}
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  292  configObject : {"is-postgres":true,"query":"select cso_org_links.node_id_n as node_id_n, count(distinct(outlet_org_master.org_id_n)) as sso3_count_n from (select source_id_n as aggregation_id_n, round((sum(dimension_1_n)\/100),0) as injection_qty_n from kpi.tr_daily_serial_injection_aggr where day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and metrics_type_n = 11 and metrics_id_n in (select metrics_id_n from kpi.ms_metrics_master where ext_metrics_id_v in (select unnest(string_to_array(property_value_v::text, ','::text)::character varying[]) from kpi.ms_property_master where property_key_v ilike 'starter_pack_master')) group by aggregation_id_n having round((sum(dimension_1_n)\/100),0) >= (select property_value_n from kpi.ms_property_master where property_key_v = 'stable_sso_injection_qty') ) as daily_event_aggr inner join kpi.ms_report_org_master as outlet_org_master on (outlet_org_master.org_type_n = 6 and outlet_org_master.aggregation_id_n = daily_event_aggr.aggregation_id_n) inner join kpi.ms_user_org_links as cso_org_links on (cso_org_links.dest_org_id_n = outlet_org_master.org_id_n and cso_org_links.status_n = 174 and 1031 = any(cso_org_links.position_id_n)) group by cso_org_links.node_id_n order by cso_org_links.node_id_n;","map-key":{"local-key":"node_id","type":"Long","key":"node_id_n"},"collection-name":"Collection-3","fields":"sso3_count_n"}
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  292  configObject : {"is-postgres":true,"query":"select daily_injection_aggr.entity_id_n as node_id_n, round((sum(daily_injection_aggr.daily_sso_outlets_n)\/(select (now()::date - date_trunc('month', now())::date)::numeric)),0) as daily_sso_n from (select daily_event_aggr.day_id_n as day_id_n, cso_org_links.node_id_n as entity_id_n, count(distinct(outlet_org_master.org_id_n)) daily_sso_outlets_n from kpi.tr_daily_serial_injection_aggr as daily_event_aggr inner join kpi.ms_report_org_master as outlet_org_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.metrics_id_n in (select metrics_id_n from kpi.ms_metrics_master where ext_metrics_id_v in (select unnest(string_to_array(property_value_v::text, ','::text)::character varying[]) from kpi.ms_property_master where property_key_v ilike 'starter_pack_master')) and outlet_org_master.org_type_n = 6 and daily_event_aggr.source_id_n = outlet_org_master.aggregation_id_n) inner join kpi.ms_user_org_links as cso_org_links on (cso_org_links.dest_org_id_n = outlet_org_master.org_id_n and cso_org_links.status_n = 174 and 1031 = any(cso_org_links.position_id_n)) group by day_id_n, entity_id_n ) as daily_injection_aggr group by daily_injection_aggr.entity_id_n order by daily_injection_aggr.entity_id_n;","map-key":{"local-key":"node_id","type":"Long","key":"node_id_n"},"collection-name":"Collection-4","fields":"daily_sso"}
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  292  configObject : {"is-postgres":true,"query":"select cso_org_links.node_id_n as node_id_n, count(distinct(outlet_org_master.org_id_n)) as uro_count_n from (select aggregation_id_n from (select redemption_aggr.source_id_n as aggregation_id_n, sum(redemption_aggr.dimension_2_n) as revenue_value_n from kpi.tr_daily_voucher_redemption_aggr as redemption_aggr where redemption_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and redemption_aggr.metrics_type_n = 11 group by redemption_aggr.source_id_n union select transaction_aggr.actor_id_n as aggregation_id_n, sum(transaction_aggr.dimension_2_n) as revenue_value_n from kpi.tr_daily_mobo_transaction_aggr as transaction_aggr where transaction_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and transaction_aggr.metrics_type_n = 21 and transaction_aggr.source_id_n = 0 and transaction_aggr.instance_type_n = 33 and transaction_aggr.instance_id_n in (select metrics_id_n from kpi.ms_metrics_master where metrics_type_n = 33 and metrics_name_v in ('Purchase Data Package', 'Indosat Reload')) group by transaction_aggr.actor_id_n ) as revenue_aggr group by aggregation_id_n having round((sum(revenue_value_n)\/100),2) >= (select property_value_n from kpi.ms_property_master where property_key_v = 'revenue_transaction_value') ) as monthly_metrics_aggr inner join kpi.ms_report_org_master as outlet_org_master on (outlet_org_master.org_type_n = 6 and outlet_org_master.aggregation_id_n = monthly_metrics_aggr.aggregation_id_n) inner join kpi.ms_user_org_links as cso_org_links on (cso_org_links.dest_org_id_n = outlet_org_master.org_id_n and cso_org_links.status_n = 174 and 1031 = any(cso_org_links.position_id_n)) group by cso_org_links.node_id_n order by cso_org_links.node_id_n;","map-key":{"local-key":"node_id","type":"Long","key":"node_id_n"},"collection-name":"Collection-5","fields":"uro"}
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  292  configObject : {"is-postgres":true,"query":"select cso_org_links.node_id_n as node_id_n, count(distinct(outlet_org_master.org_id_n)) as uro20_count_n from (select aggregation_id_n from (select redemption_aggr.source_id_n as aggregation_id_n, sum(redemption_aggr.dimension_2_n) as revenue_value_n from kpi.tr_daily_voucher_redemption_aggr as redemption_aggr where redemption_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and redemption_aggr.metrics_type_n = 11 group by redemption_aggr.source_id_n union select transaction_aggr.actor_id_n as aggregation_id_n, sum(transaction_aggr.dimension_2_n) as revenue_value_n from kpi.tr_daily_mobo_transaction_aggr as transaction_aggr where transaction_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and transaction_aggr.metrics_type_n = 21 and transaction_aggr.source_id_n = 0 and transaction_aggr.instance_type_n = 33 and transaction_aggr.instance_id_n in (select metrics_id_n from kpi.ms_metrics_master where metrics_type_n = 33 and metrics_name_v in ('Purchase Data Package', 'Indosat Reload')) group by transaction_aggr.actor_id_n ) as revenue_aggr group by revenue_aggr.aggregation_id_n having round((sum(revenue_aggr.revenue_value_n)\/100),2) >= (select property_value_n from kpi.ms_property_master where property_key_v = 'stable_uro_revenue_value') ) as monthly_metrics_aggr inner join kpi.ms_report_org_master as outlet_org_master on (outlet_org_master.org_type_n = 6 and outlet_org_master.aggregation_id_n = monthly_metrics_aggr.aggregation_id_n) inner join kpi.ms_user_org_links as cso_org_links on (cso_org_links.dest_org_id_n = outlet_org_master.org_id_n and cso_org_links.status_n = 174 and 1031 = any(cso_org_links.position_id_n)) group by cso_org_links.node_id_n order by cso_org_links.node_id_n;","map-key":{"local-key":"node_id","type":"Long","key":"node_id_n"},"collection-name":"Collection-6","fields":"uro_20k_plus"}
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  292  configObject : {"is-postgres":true,"query":"select daily_uro_aggr.node_id_n as node_id_n, round((sum(daily_uro_outlets_n)\/(select (now()::date - date_trunc('month', now())::date)::numeric)),0) as daily_uro_n from (select revenue_aggr.day_id_n as day_id_n, cso_org_links.node_id_n as node_id_n, count(distinct(outlet_org_master.org_id_n)) as daily_uro_outlets_n from (select redemption_aggr.day_id_n as day_id_n, redemption_aggr.source_id_n as aggregation_id_n, sum(redemption_aggr.dimension_2_n) as revenue_value_n from kpi.tr_daily_voucher_redemption_aggr as redemption_aggr where redemption_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and redemption_aggr.metrics_type_n = 11 group by redemption_aggr.day_id_n, redemption_aggr.source_id_n union select transaction_aggr.day_id_n as day_id_n, transaction_aggr.actor_id_n as aggregation_id_n, sum(transaction_aggr.dimension_2_n) as revenue_value_n from kpi.tr_daily_mobo_transaction_aggr as transaction_aggr where transaction_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and transaction_aggr.metrics_type_n = 21 and transaction_aggr.source_id_n = 0 and transaction_aggr.instance_type_n = 33 and transaction_aggr.instance_id_n in (select metrics_id_n from kpi.ms_metrics_master where metrics_type_n = 33 and metrics_name_v in ('Purchase Data Package', 'Indosat Reload')) group by transaction_aggr.day_id_n, transaction_aggr.actor_id_n ) as revenue_aggr inner join kpi.ms_report_org_master as outlet_org_master on (outlet_org_master.org_type_n = 6 and outlet_org_master.aggregation_id_n = revenue_aggr.aggregation_id_n) inner join kpi.ms_user_org_links as cso_org_links on (cso_org_links.dest_org_id_n = outlet_org_master.org_id_n and cso_org_links.status_n = 174 and 1031 = any(cso_org_links.position_id_n)) group by day_id_n, node_id_n having round((sum(revenue_value_n)\/100),2) >= (select property_value_n from kpi.ms_property_master where property_key_v = 'revenue_transaction_value') ) as daily_uro_aggr group by daily_uro_aggr.node_id_n order by daily_uro_aggr.node_id_n;","map-key":{"local-key":"node_id","type":"Long","key":"node_id_n"},"collection-name":"Collection-7","fields":"daily_uro"}
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  292  configObject : {"is-postgres":true,"query":"select cso_node_master.node_id_n, sum(mobo_summary_aggr.mobo_high_n) as mobo_sellin_count_n from kpi.tr_mobo_summary_aggr as mobo_summary_aggr inner join kpi.ms_report_node_master as cso_node_master on (mobo_summary_aggr.month_id_n = to_char((date_trunc('month', current_date))::date,'yyyymm')::numeric and cso_node_master.node_id_n = mobo_summary_aggr.node_id_n) group by cso_node_master.node_id_n order by cso_node_master.node_id_n;","map-key":{"local-key":"node_id","type":"Long","key":"node_id_n"},"collection-name":"Collection-8","fields":"mobo_sellin_ge50k"}
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  292  configObject : {"connection-id":"snoc-r5","is-lookup":true,"schema-name":"daily_dump_snapshot","projection":{"region_name":1},"collection-name":"outlet_hierachy_dump","fields":"region,hor_name,area,hos_name,sales_area,sam_name,csm_name,cso_name"}
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  366  Query Object : { }
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  422  mongoCursors size : 2
Mar 01, 2020 3:24:52 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  455  Exit getMongoCursor..
Mar 01, 2020 3:24:54 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  8139  Entry createInterfaceFileSummary.. Started at --> Sun Mar 01 15:24:54 IST 2020
Mar 01, 2020 3:24:54 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  8152  createInterfaceFileSummary service received interfaceFileSummary for file id-->null
Mar 01, 2020 3:24:54 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  8227  Exit createInterfaceFileSummary service at -->Sun Mar 01 15:24:54 IST 2020 --- and took 46 milliseconds
Mar 01, 2020 3:24:54 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  7586  Entry createControlFile.. Started at --> Sun Mar 01 15:24:54 IST 2020
Mar 01, 2020 3:24:54 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  7601  createControlFile service received filePath -->/home/appuser/interfaces/S-NOC/interfaces/master_file/daily_dumps/cso_sales/CSO_Sales_20200301.csvtotalCount-->83fileName-->CSO_Sales_20200301fileFormat-->csvcurrentFileId-->10857contolFileFormat-->ctlcontolFilePath-->/home/appuser/interfaces/S-NOC/interfaces/master_file/daily_dumps/cso_sales/
Mar 01, 2020 3:24:54 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  8056  updateInterfaceFileSummaryDetails service received interfaceFileSummaryDetails object for file details id-->10857
Mar 01, 2020 3:24:54 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  7665  Exit control file creation service at -->Sun Mar 01 15:24:54 IST 2020 --- and took 101 milliseconds
Mar 01, 2020 3:24:54 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.processor.OutletSalesDump [LineNumber]:  556  OutletSalesDump : Exit processRequest... Took : 3221 milliseconds
Mar 01, 2020 3:24:54 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  8909  Completed pullDataToFile.. 1157  Service at --> Sun Mar 01 15:24:54 IST 2020 --- and took 3231 milliseconds
Mar 01, 2020 3:24:54 PM com.enhancesys.common.logger
FINE: [Thread]: 235 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  8975  Exit pullData service at -->Sun Mar 01 15:24:54 IST 2020 --- and took 3235 milliseconds
