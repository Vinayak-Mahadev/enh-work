Mar 02, 2020 5:35:07 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.TokuUser [LineNumber]:  33  Initiating TokuMx-Java Adapter.....
Mar 02, 2020 5:35:07 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.TokuUser [LineNumber]:  42  TokuMx-Java Adapter Initiated Successfully For Replica-Set user....!
Mar 02, 2020 5:35:08 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  8746  Entry pullDataToFile.. Started at --> Mon Mar 02 17:35:08 IST 2020
Mar 02, 2020 5:35:08 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  8749  pullDataToFile service received interface id-->[1156]
Mar 02, 2020 5:35:08 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  8787  Started pullDataToFile.. 1156  Started at --> Mon Mar 02 17:35:08 IST 2020
Mar 02, 2020 5:35:08 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  8888  [dataConverter] class com.sun.proxy.$Proxy209
Mar 02, 2020 5:35:08 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.processor.OutletSalesDump [LineNumber]:  75  OutletSalesDump :: Entry processRequest ... InterfaceId : 1156, RequiredDate : null
Mar 02, 2020 5:35:08 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  9467  Entry readFilePropertyBeans.. Started at --> Mon Mar 02 17:35:08 IST 2020
Mar 02, 2020 5:35:08 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  9481  readFilePropertyBeans service received interface id-->1156
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.IntegrationManagementImpl [LineNumber]:  10283  Exit readFilePropertyBeans service at -->Mon Mar 02 17:35:09 IST 2020 --- and took 294 milliseconds
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.processor.OutletSalesDump [LineNumber]:  169  Interface : 1156 : File : Outlet_Sales_20200302.csv
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  187  Entry getPGCursor..
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"sort-by":{"_id":1},"connection-id":"snoc-r1","schema-name":"snoc","projection":{"_id":1},"collection-name":"organization_prod","parameters":[]}
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  219  pgCursors size : 0
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"is-postgres":true,"query":"select outlet_node_master.org_id_n, outlet_node_master.org_short_code_v, round((sum(daily_event_aggr.dimension_1_n)\/100),0) as starter_pack_count from kpi.tr_daily_event_metrics_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.event_type_n = 2 and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.metrics_id_n in (select metrics_id_n from kpi.ms_metrics_master where ext_metrics_id_v in (select unnest(string_to_array(property_value_v::text, ','::text)::character varying[]) from kpi.ms_property_master where property_key_v ilike 'starter_pack_master')) and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n != daily_event_aggr.source_id_n) group by outlet_node_master.org_id_n, outlet_node_master.org_short_code_v order by outlet_node_master.org_id_n;","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-2","fields":"starter_pack_count"}
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  219  pgCursors size : 1
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"is-postgres":true,"query":"select outlet_node_master.org_id_n, outlet_node_master.org_short_code_v, round((sum(daily_event_aggr.dimension_1_n)\/100),0) as voucher_count from kpi.tr_daily_event_metrics_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.event_type_n = 2 and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.metrics_id_n in (select metrics_id_n from kpi.ms_metrics_master where ext_metrics_id_v in (select unnest(string_to_array(property_value_v::text, ','::text)::character varying[]) from kpi.ms_property_master where property_key_v ilike 'voucher_master')) and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n != daily_event_aggr.source_id_n) group by outlet_node_master.org_id_n, outlet_node_master.org_short_code_v order by outlet_node_master.org_id_n;","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-3","fields":"voucher_count"}
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  219  pgCursors size : 2
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"is-postgres":true,"query":"select outlet_node_master.org_id_n, outlet_node_master.org_short_code_v, round((sum(daily_event_aggr.dimension_1_n)\/100),0) as activation_count from kpi.tr_daily_serial_activation_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n = daily_event_aggr.source_id_n) group by outlet_node_master.org_id_n, outlet_node_master.org_short_code_v order by outlet_node_master.org_id_n;","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-4","fields":"act1_msisdn_count"}
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  219  pgCursors size : 3
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"is-postgres":true,"query":"select outlet_node_master.org_id_n, outlet_node_master.org_short_code_v, round((sum(daily_event_aggr.dimension_1_n)\/100),0) as injection_count from kpi.tr_daily_serial_injection_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n = daily_event_aggr.source_id_n) group by outlet_node_master.org_id_n, outlet_node_master.org_short_code_v order by outlet_node_master.org_id_n;","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-5","fields":"ga_fr_msisdn_count"}
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  219  pgCursors size : 4
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"is-postgres":true,"query":"select outlet_node_master.org_id_n, outlet_node_master.org_short_code_v, round((sum(daily_event_aggr.dimension_1_n)\/100),0) as rguga_count from kpi.tr_daily_serial_rguga_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n = daily_event_aggr.source_id_n) group by outlet_node_master.org_id_n, outlet_node_master.org_short_code_v order by outlet_node_master.org_id_n;","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-6","fields":"rgu_ga_msisdn_count"}
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  219  pgCursors size : 5
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"is-postgres":true,"query":"select outlet_org_master.org_id_n, outlet_org_master.org_short_code_v, round((sum(daily_event_aggr.dimension_2_n)\/100),0) as mobo_sellout_value from kpi.tr_daily_mobo_transaction_aggr as daily_event_aggr inner join kpi.ms_report_org_master as outlet_org_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.actor_id_n = outlet_org_master.aggregation_id_n and outlet_org_master.org_type_n = 6) group by outlet_org_master.org_id_n, outlet_org_master.org_short_code_v order by outlet_org_master.org_id_n;","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-7","fields":"mobo_sellout_value"}
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  219  pgCursors size : 6
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"is-postgres":true,"query":"select outlet_node_master.org_id_n, outlet_node_master.org_short_code_v, round((sum(daily_event_aggr.dimension_1_n)\/100),0) as vc_redeem_value from kpi.tr_daily_voucher_redemption_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n = daily_event_aggr.source_id_n) group by outlet_node_master.org_id_n, outlet_node_master.org_short_code_v order by outlet_node_master.org_id_n;","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-8","fields":"vc_redeem_value"}
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  219  pgCursors size : 7
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"is-postgres":true,"query":"select outlet_node_master.org_id_n, outlet_node_master.org_short_code_v, round((sum(daily_event_aggr.dimension_1_n)\/100),0) as mobo_sellin_value from kpi.tr_daily_balance_transfer_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.metrics_id_n in (select metrics_id_n from kpi.ms_metrics_master where ext_metrics_id_v in (select unnest(string_to_array(property_value_v::text, ','::text)::character varying[]) from kpi.ms_property_master where property_key_v ilike 'e-voucher_master')) and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n != daily_event_aggr.source_id_n) group by outlet_node_master.org_id_n, outlet_node_master.org_short_code_v order by outlet_node_master.org_id_n; ","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-9","fields":"mobo_sellin_value"}
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  219  pgCursors size : 8
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  204  collectionObj : {"sort-by":{"outlet_org_id":1},"connection-id":"snoc-r5","schema-name":"daily_dump_snapshot","projection":{"outlet_org_id":1,"sales_area_name":1,"hos_name":1,"cso_mobile_number":1,"outlet_code":1,"csm_name":1,"hor_name":1,"cso_code":1,"sam_name":1,"region_name":1,"outlet_name":1,"outlet_mobile_number":1,"sub_area_name":1},"map-key":{"local-key":"_id","type":"Long","key":"outlet_org_id"},"collection-name":"outlet_hierachy_dump_prod","fields":"region,hor_name,area,hos_name,sales_area,sam_name,csm_name,cso_name,outlet_ref_id,outlet_name,contact_number,mobo_number"}
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  219  pgCursors size : 8
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  241  Exit getPGCursor..
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  260  Entry getMongoCursor..
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  296  configObject : {"sort-by":{"_id":1},"connection-id":"snoc-r1","schema-name":"snoc","projection":{"_id":1},"collection-name":"organization_prod","parameters":[]}
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  370  Query Object : { }
Mar 02, 2020 5:35:09 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  385  SortColumns : [_id]
Mar 02, 2020 5:35:56 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  406  Sort file script is initiated for file :: /home/appuser/snoc/snocconf/interfaceconf/sort/organization_prod_20200302173509502.csv.cp
Mar 02, 2020 5:35:56 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  407  Script file : /home/appuser/snoc/snocconf/interfaceconf/sort/collection1.sh
Mar 02, 2020 5:35:59 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  409  Process : waitFor() :: 0
Mar 02, 2020 5:35:59 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  426  mongoCursors size : 1
Mar 02, 2020 5:35:59 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  296  configObject : {"is-postgres":true,"query":"select outlet_node_master.org_id_n, outlet_node_master.org_short_code_v, round((sum(daily_event_aggr.dimension_1_n)\/100),0) as starter_pack_count from kpi.tr_daily_event_metrics_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.event_type_n = 2 and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.metrics_id_n in (select metrics_id_n from kpi.ms_metrics_master where ext_metrics_id_v in (select unnest(string_to_array(property_value_v::text, ','::text)::character varying[]) from kpi.ms_property_master where property_key_v ilike 'starter_pack_master')) and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n != daily_event_aggr.source_id_n) group by outlet_node_master.org_id_n, outlet_node_master.org_short_code_v order by outlet_node_master.org_id_n;","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-2","fields":"starter_pack_count"}
Mar 02, 2020 5:35:59 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  296  configObject : {"is-postgres":true,"query":"select outlet_node_master.org_id_n, outlet_node_master.org_short_code_v, round((sum(daily_event_aggr.dimension_1_n)\/100),0) as voucher_count from kpi.tr_daily_event_metrics_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.event_type_n = 2 and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.metrics_id_n in (select metrics_id_n from kpi.ms_metrics_master where ext_metrics_id_v in (select unnest(string_to_array(property_value_v::text, ','::text)::character varying[]) from kpi.ms_property_master where property_key_v ilike 'voucher_master')) and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n != daily_event_aggr.source_id_n) group by outlet_node_master.org_id_n, outlet_node_master.org_short_code_v order by outlet_node_master.org_id_n;","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-3","fields":"voucher_count"}
Mar 02, 2020 5:35:59 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  296  configObject : {"is-postgres":true,"query":"select outlet_node_master.org_id_n, outlet_node_master.org_short_code_v, round((sum(daily_event_aggr.dimension_1_n)\/100),0) as activation_count from kpi.tr_daily_serial_activation_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n = daily_event_aggr.source_id_n) group by outlet_node_master.org_id_n, outlet_node_master.org_short_code_v order by outlet_node_master.org_id_n;","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-4","fields":"act1_msisdn_count"}
Mar 02, 2020 5:35:59 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  296  configObject : {"is-postgres":true,"query":"select outlet_node_master.org_id_n, outlet_node_master.org_short_code_v, round((sum(daily_event_aggr.dimension_1_n)\/100),0) as injection_count from kpi.tr_daily_serial_injection_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n = daily_event_aggr.source_id_n) group by outlet_node_master.org_id_n, outlet_node_master.org_short_code_v order by outlet_node_master.org_id_n;","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-5","fields":"ga_fr_msisdn_count"}
Mar 02, 2020 5:35:59 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  296  configObject : {"is-postgres":true,"query":"select outlet_node_master.org_id_n, outlet_node_master.org_short_code_v, round((sum(daily_event_aggr.dimension_1_n)\/100),0) as rguga_count from kpi.tr_daily_serial_rguga_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n = daily_event_aggr.source_id_n) group by outlet_node_master.org_id_n, outlet_node_master.org_short_code_v order by outlet_node_master.org_id_n;","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-6","fields":"rgu_ga_msisdn_count"}
Mar 02, 2020 5:35:59 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  296  configObject : {"is-postgres":true,"query":"select outlet_org_master.org_id_n, outlet_org_master.org_short_code_v, round((sum(daily_event_aggr.dimension_2_n)\/100),0) as mobo_sellout_value from kpi.tr_daily_mobo_transaction_aggr as daily_event_aggr inner join kpi.ms_report_org_master as outlet_org_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.actor_id_n = outlet_org_master.aggregation_id_n and outlet_org_master.org_type_n = 6) group by outlet_org_master.org_id_n, outlet_org_master.org_short_code_v order by outlet_org_master.org_id_n;","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-7","fields":"mobo_sellout_value"}
Mar 02, 2020 5:35:59 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  296  configObject : {"is-postgres":true,"query":"select outlet_node_master.org_id_n, outlet_node_master.org_short_code_v, round((sum(daily_event_aggr.dimension_1_n)\/100),0) as vc_redeem_value from kpi.tr_daily_voucher_redemption_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n = daily_event_aggr.source_id_n) group by outlet_node_master.org_id_n, outlet_node_master.org_short_code_v order by outlet_node_master.org_id_n;","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-8","fields":"vc_redeem_value"}
Mar 02, 2020 5:35:59 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  296  configObject : {"is-postgres":true,"query":"select outlet_node_master.org_id_n, outlet_node_master.org_short_code_v, round((sum(daily_event_aggr.dimension_1_n)\/100),0) as mobo_sellin_value from kpi.tr_daily_balance_transfer_aggr as daily_event_aggr inner join kpi.ms_report_node_master as outlet_node_master on (daily_event_aggr.day_id_n between to_char((date_trunc('month', current_date))::date,'yyyymmdd')::numeric and to_char(now() -'1 day'::interval,'yyyymmdd')::numeric and daily_event_aggr.metrics_type_n = 11 and daily_event_aggr.metrics_id_n in (select metrics_id_n from kpi.ms_metrics_master where ext_metrics_id_v in (select unnest(string_to_array(property_value_v::text, ','::text)::character varying[]) from kpi.ms_property_master where property_key_v ilike 'e-voucher_master')) and daily_event_aggr.actor_id_n = outlet_node_master.aggregation_id_n and outlet_node_master.org_type_n = 6 and outlet_node_master.org_aggr_id_n != daily_event_aggr.source_id_n) group by outlet_node_master.org_id_n, outlet_node_master.org_short_code_v order by outlet_node_master.org_id_n; ","map-key":{"local-key":"_id","type":"Long","key":"org_id_n"},"collection-name":"Collection-9","fields":"mobo_sellin_value"}
Mar 02, 2020 5:35:59 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  296  configObject : {"sort-by":{"outlet_org_id":1},"connection-id":"snoc-r5","schema-name":"daily_dump_snapshot","projection":{"outlet_org_id":1,"sales_area_name":1,"hos_name":1,"cso_mobile_number":1,"outlet_code":1,"csm_name":1,"hor_name":1,"cso_code":1,"sam_name":1,"region_name":1,"outlet_name":1,"outlet_mobile_number":1,"sub_area_name":1},"map-key":{"local-key":"_id","type":"Long","key":"outlet_org_id"},"collection-name":"outlet_hierachy_dump_prod","fields":"region,hor_name,area,hos_name,sales_area,sam_name,csm_name,cso_name,outlet_ref_id,outlet_name,contact_number,mobo_number"}
Mar 02, 2020 5:35:59 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  370  Query Object : { }
Mar 02, 2020 5:35:59 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  385  SortColumns : [outlet_org_id]
Mar 02, 2020 5:38:43 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  406  Sort file script is initiated for file :: /home/appuser/snoc/snocconf/interfaceconf/sort/outlet_hierachy_dump_prod_20200302173559406.csv.cp
Mar 02, 2020 5:38:43 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  407  Script file : /home/appuser/snoc/snocconf/interfaceconf/sort/collection1.sh

Mar 02, 2020 5:40:38 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  409  Process : waitFor() :: 0
Mar 02, 2020 5:40:38 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  426  mongoCursors size : 2
Mar 02, 2020 5:40:38 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.util.CursorUtil [LineNumber]:  459  Exit getMongoCursor..
Mar 02, 2020 5:40:38 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.processor.OutletSalesDump [LineNumber]:  203  mongoCursorMap keySet : [outlet_hierachy_dump_prod, organization_prod]
Mar 02, 2020 5:40:38 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.processor.OutletSalesDump [LineNumber]:  204  pgCursorMap keySet : [Collection-5, Collection-6, Collection-3, Collection-4, Collection-2, Collection-9, Collection-7, Collection-8]
Mar 02, 2020 5:40:38 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.processor.OutletSalesDump [LineNumber]:  205  collectionConfMap keySet : [Collection-5, outlet_hierachy_dump_prod, Collection-6, Collection-3, Collection-4, Collection-2, organization_prod, Collection-9, Collection-7, Collection-8]
Mar 02, 2020 5:40:38 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.processor.OutletSalesDump [LineNumber]:  285  Inside Mongo primary..
Mar 02, 2020 5:40:38 PM com.enhancesys.common.logger
FINE: [Thread]: 214 [ClassName]: com.enhancesys.integration.services.processor.OutletSalesDump [LineNumber]:  363  Inside BufferReader..
