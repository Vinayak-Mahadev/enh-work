  24074 | 05:00:10.12837  | select * from kpi.fetch_kpi_memory_details;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | active
  24017 | 07:57:16.360259 | select 'Summary_CS_SP_Act' as report_name, report_day_master.date_v as date, report_org_master.channel_category_v as channel, report_network_master.region_v as region, report_network_master.area_v as area, report_network_master.sales_area_v as salesarea, report_network_master.cluster_v as cluster, report_network_master.micro_cluster_v as microcluster, groupby_query_results.territoryid as territoryid, null as additionalterritory, report_product_master.product_code_v as physicalproductcode, report_product_master.product_category_name_v as physicalproductcategory, report_product_master.product_name_v as physicalproductname, groupby_query_results.territorycrossellingtype as territorycrossellingtype, null as totalvalue, groupby_query_results.totalqty as totalqty, null as crossellingactivationvalue, groupby_query_results.crossellingactivationqty as crossellingactivationqty, null as inneractivationvalue, groupby_query_results.inneractivationqty as inneractivationqty from (select daily_metrics_aggr.day_id_n as day_i | active
  54462 | 10:12:01.020099 | select 'Detail_CS_Reload_of_e_voucher' as report_name, report_day_master.date_v as date, report_org_master.channel_category_v as channel, report_network_master.region_v as region, report_network_master.area_v as area, report_network_master.sales_area_v as salesarea, report_network_master.cluster_v as cluster, report_network_master.micro_cluster_v as microcluster, groupby_query_results.instance_id_n as territoryid, null as additionalterritory, report_product_master.product_code_v as physicalproductcode, report_product_master.product_category_name_v as physicalproductcategory, report_product_master.product_name_v as physicalproductname, groupby_query_results.instance_type_n as territorycrossellingtype, report_network_master.lac_id_v as lacid, report_network_master.cell_id_v as cellid, case when (groupby_query_results.data_flag_n = 3) then origin_cluster.lookup_name_v else null end as bterritoryname, case when (groupby_query_results.data_flag_n = 3) then origin_cluster.lookup_id_n else null end as bterritoryid, | active
  54116 | 10:12:53.486013 | select 'Sum_CS_Reload_of_e_voucher' as report_name, report_day_master.date_v as date, report_org_master.channel_category_v as channel, report_network_master.region_v as region, report_network_master.area_v as area, report_network_master.sales_area_v as salesarea, report_network_master.cluster_v as cluster, report_network_master.micro_cluster_v as microcluster, groupby_query_results.territoryid as territoryid, null as additionalterritory, report_product_master.product_code_v as physicalproductcode, report_product_master.product_category_name_v as physicalproductcategory, report_product_master.product_name_v as physicalproductname, groupby_query_results.territorycrossellingtype as territorycrossellingtype, null as totalqty, groupby_query_results.totalamount as totalamount, null as crossellingactivationqty, groupby_query_results.crossellingactivationamount as crossellingactivationamount, null as inneractivationqty, groupby_query_results.inneractivationamount as inneractivationamount from (select daily_upload_me | active
  53931 | 10:13:23.91981  | select 'CS_Reload_Physical_Report' as report_name, report_day_master.date_v as date, report_org_master.channel_category_v as channel, report_network_master.region_v as region, report_network_master.area_v as area, report_network_master.sales_area_v as salesarea, report_network_master.cluster_v as cluster, report_network_master.micro_cluster_v as microcluster, groupby_query_results.instance_type_n as territoryid, null as additionalterritory, report_product_master.product_code_v as physicalproductcode, report_product_master.product_category_name_v as physicalproductcategory, report_product_master.product_name_v as physicalproductname, groupby_query_results.instance_id_n as territorycrossellingtype, report_network_master.lac_id_v as lacid, report_network_master.cell_id_v as cellid, null as targetterritoryname, null as targetterritoryid, null as totalvalue, groupby_query_results.totalqty as totalqty from (select daily_event_metrics_aggr.day_id_n as day_id_n, daily_event_metrics_aggr.actor_id_n as actor_id_n, dai | active
  53702 | 10:14:02.364013 | select 'Summary_CS_Reload_Physical_Report' as report_name, report_day_master.date_v as date, report_org_master.channel_category_v as channel, report_network_master.region_v as region, report_network_master.area_v as area, report_network_master.sales_area_v as salesarea, report_network_master.cluster_v as cluster, report_network_master.micro_cluster_v as microcluster, groupby_query_results.territoryid as territoryid, null as additionalterritory, report_product_master.product_code_v as physicalproductcode, report_product_master.product_category_name_v as physicalproductcategory, report_product_master.product_name_v as physicalproductname, groupby_query_results.territorycrossellingtype as territorycrossellingtype, null as totalvalue, groupby_query_results.totalqty as totalqty, null as crossellingactivationvalue, groupby_query_results.crossellingactivationqty as crossellingactivationqty, null as inneractivationvalue, groupby_query_results.inneractivationqty as inneractivationqty from (select daily_event_metrics_ | active
  53329 | 10:14:50.306931 | select 'Detail_Package_Activation_B' as report_name, report_day_master.date_v as date, null as channel, report_network_master.region_v as region, report_network_master.area_v as area, report_network_master.sales_area_v as salesarea, report_network_master.cluster_v as cluster, report_network_master.micro_cluster_v as microcluster, null as additionalterritory, report_network_master.territory_code_v as territoryid, report_network_master.lac_id_v as lacid, report_network_master.cell_id_v as cellid, system_source.metrics_name_v as systemsource, null as sid, null as smstext, report_product_master.product_code_v as packagecode, report_product_master.product_name_v as packagename, groupby_query_results.activation_qty as qty, groupby_query_results.activation_value as amount from (select daily_upload_metrics_aggr.day_id_n as day_id_n, daily_upload_metrics_aggr.event_type_n as event_type_n, daily_upload_metrics_aggr.actor_id_n as actor_id_n, daily_upload_metrics_aggr.metrics_type_n as metrics_type_n, daily_upload_metri | active
  53314 | 10:14:51.642312 | select 'Detail_Package_Activation_A' as report_name, report_day_master.date_v as date, null as channel, report_network_master.region_v as region, report_network_master.area_v as area, report_network_master.sales_area_v as salesarea, report_network_master.cluster_v as cluster, report_network_master.micro_cluster_v as microcluster, null as additionalterritory, report_network_master.territory_code_v as territoryid, report_network_master.lac_id_v as lacid, report_network_master.cell_id_v as cellid, system_source.metrics_name_v as systemsource, null as sid, null as smstext, report_product_master.product_code_v as packagecode, report_product_master.product_name_v as packagename, groupby_query_results.activation_qty as qty, groupby_query_results.activation_value as amount from (select daily_upload_metrics_aggr.day_id_n as day_id_n, daily_upload_metrics_aggr.event_type_n as event_type_n, daily_upload_metrics_aggr.actor_id_n as actor_id_n, daily_upload_metrics_aggr.metrics_type_n as metrics_type_n, daily_upload_metri | active
  53301 | 10:14:52.043172 | select 'Hotspot_Performance' as report_name, report_day_master.date_v as datetime, report_node_master.channel_category_v as channel, report_node_master.region_v as region, report_node_master.area_v as area, report_node_master.sales_area_v as salesarea, report_node_master.cluster_v as cluster, report_node_master.micro_cluster_v as microcluster, null as additionalterritory, report_node_master.org_short_code_v as territoryid, report_node_master.sub_org_type_name_v as hotspottype, report_node_master.hospot_category_v as hotspotcategory, null as hostspotradiusrange, report_node_master.org_id_n as hotspotid, report_node_master.hotspot_name_v as hotspotname, null as additionalinformation, case when(groupby_query_results.event_type_n = 2) then 'sellin' else case when(groupby_query_results.event_type_n = 3)then 'sellout' end end as transactiontype, groupby_query_results.transaction_hits as transactionhits, groupby_query_results.transaction_value as transactionvalue from (select daily_metrics_aggr.day_id_n as day_id_n | active
  53283 | 10:14:53.521957 | select 'SOM_Summary_Organization_Wise' as report_name, report_org_master.channel_category_v as channel, report_org_master.region_v as region, report_org_master.area_v as area, report_org_master.sales_area_v as salesarea, report_org_master.cluster_v as cluster, report_org_master.micro_cluster_v as microcluster, null as additionalterritory, report_org_master.org_short_code_v as territoryid, report_org_master.sub_org_type_name_v as suborgtype, report_org_master.org_id_n::text as organizationid, report_org_master.org_short_code_v as orgshortcode, report_org_master.org_name_v as organizationname, report_product_master.brand_name_v as productbrand, null as producttype, report_product_master.product_category_name_v as productcategory, report_product_master.product_id_n::text as productid, report_product_master.product_code_v as productextid, report_product_master.product_name_v as productname, sum(groupby_query_results.closing_qty_n) as qty, case when (sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_r | active
  53211 | 10:14:57.79389  | select 'SOM_Summary_Territory' as report_name, report_org_master.channel_category_v as channel, report_org_master.region_v as region, report_org_master.area_v as area, report_org_master.sales_area_v as salesarea, report_org_master.cluster_v as cluster, report_org_master.micro_cluster_v as microcluster, null as additionalterritory, report_org_master.org_short_code_v as territoryid, report_product_master.brand_name_v as productbrand, null as producttype, report_product_master.product_category_name_v as productcategory, report_product_master.product_name_v as productname, report_product_master.product_id_n::text as productid, report_product_master.product_code_v as productextid, sum(groupby_query_results.closing_qty_n) as qty, case when (sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_results.stock_out_qty_n)) > 0 then round(((sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_results.stock_out_qty_n))/7),0) else (sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_results.sto | active
   4811 | 11:15:00.150575 | COPY (SELECT relkind,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +| active
        |                 |        relname,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +| 
        |                 |        pg_catalog.pg_namespace.nspname,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +| 
        |                 |        pg_size_pretty(pg_relation_size(pg_catalog.pg_class.oid))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +| 
        |                 | FROM   pg_catalog.pg_class                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +| 
        |                 |        INNER JOIN pg_catalog.pg_namespace                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +| 
        |                 |          ON relnamespace = pg_catalog.pg_namespace.oid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +| 
        |                 | ORDER  BY pg_catalog.pg_namespace.nspname,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +| 
        |                 |           pg_relation_size(pg_catalog.pg_class.oid) DESC) to '/tmp/indosat_tablesize.csv' with csv header;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 
 123400 | 11:30:01.484067 | drop table if exists kpi.ms_report_product_master cascade                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | active


QUERY :
SELECT * from INTERFACE.MS_INTERFACE_ATTR where (name_v = 'query' or name_v = 'Remote File') and interface_id_n in (1094,1106,1109,1112,1113,1124,1125,1126,1127,1128) order by 1;


attribute_id_n|instance_id_n|name_v|value_v

1094005|1094|Remote File|SOM_Summary_Territory
1094029|1094|query|select 'SOM_Summary_Territory' as report_name, report_org_master.channel_category_v as channel, report_org_master.region_v as region, report_org_master.area_v as area, report_org_master.sales_area_v as salesarea, report_org_master.cluster_v as cluster, report_org_master.micro_cluster_v as microcluster, null as additionalterritory, report_org_master.org_short_code_v as territoryid, report_product_master.brand_name_v as productbrand, null as producttype, report_product_master.product_category_name_v as productcategory, report_product_master.product_name_v as productname, report_product_master.product_id_n::text as productid, report_product_master.product_code_v as productextid, sum(groupby_query_results.closing_qty_n) as qty, case when (sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_results.stock_out_qty_n)) > 0 then round(((sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_results.stock_out_qty_n))/7),0) else (sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_results.stock_out_qty_n)) end as avgqty, case when (sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_results.stock_out_qty_n)) > 0 and round(((sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_results.stock_out_qty_n))/7),0) > 0 then round((sum(groupby_query_results.closing_qty_n)/round(((sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_results.stock_out_qty_n))/7),0)),0) else -1 end as businessdays from (select daily_stock_ledger.org_id_n as org_id_n, daily_stock_ledger.metrics_id_n as metrics_id_n, sum(daily_stock_ledger.closing_stock_qty_n) as closing_qty_n, sum(average_stock_ledger.stock_in_qty_n) as stock_in_qty_n, sum(average_stock_ledger.stock_out_qty_n) as stock_out_qty_n from kpi.tr_daily_stock_ledger as daily_stock_ledger inner join kpi.tr_daily_stock_ledger as average_stock_ledger on (daily_stock_ledger.day_id_n = (select to_number(to_char((select date 'yesterday'),'yyyymmdd'),'99999999')) and average_stock_ledger.day_id_n between (select to_char((select date 'yesterday' - interval '6 days'),'yyyymmdd')::numeric) and daily_stock_ledger.day_id_n and daily_stock_ledger.account_id_n = average_stock_ledger.account_id_n and daily_stock_ledger.node_id_n = average_stock_ledger.node_id_n and daily_stock_ledger.org_id_n = average_stock_ledger.org_id_n and daily_stock_ledger.metrics_id_n = average_stock_ledger.metrics_id_n) group by daily_stock_ledger.org_id_n, daily_stock_ledger.metrics_id_n ) as groupby_query_results inner join kpi.ms_report_org_link_hierarchy as org_link_hierarchy on (org_link_hierarchy.parent_org_id_n = 20) inner join kpi.ms_report_org_master as report_org_master on (report_org_master.org_id_n = org_link_hierarchy.child_org_id_n and report_org_master.org_id_n = groupby_query_results.org_id_n) inner join kpi.ms_report_product_master as report_product_master on (report_product_master.product_id_n = groupby_query_results.metrics_id_n) group by channel, region, area, salesarea, cluster, microcluster, additionalterritory, territoryid, producttype, productbrand, productcategory, productname, productid, productextid

1106005|1106|Remote File|SOM_Summary_Organization_Wise
1106029|1106|query|select 'SOM_Summary_Organization_Wise' as report_name, report_org_master.channel_category_v as channel, report_org_master.region_v as region, report_org_master.area_v as area, report_org_master.sales_area_v as salesarea, report_org_master.cluster_v as cluster, report_org_master.micro_cluster_v as microcluster, null as additionalterritory, report_org_master.org_short_code_v as territoryid, report_org_master.sub_org_type_name_v as suborgtype, report_org_master.org_id_n::text as organizationid, report_org_master.org_short_code_v as orgshortcode, report_org_master.org_name_v as organizationname, report_product_master.brand_name_v as productbrand, null as producttype, report_product_master.product_category_name_v as productcategory, report_product_master.product_id_n::text as productid, report_product_master.product_code_v as productextid, report_product_master.product_name_v as productname, sum(groupby_query_results.closing_qty_n) as qty, case when (sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_results.stock_out_qty_n)) > 0 then round(((sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_results.stock_out_qty_n))/7),0) else (sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_results.stock_out_qty_n)) end as avgqty, case when (sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_results.stock_out_qty_n)) > 0 and round(((sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_results.stock_out_qty_n))/7),0) > 0 then round((sum(groupby_query_results.closing_qty_n)/round(((sum(groupby_query_results.stock_in_qty_n) - sum(groupby_query_results.stock_out_qty_n))/7),0)),0) else -1 end as businessdays from (select daily_stock_ledger.org_id_n as org_id_n, daily_stock_ledger.metrics_id_n as metrics_id_n, sum(daily_stock_ledger.closing_stock_qty_n) as closing_qty_n, sum(average_stock_ledger.stock_in_qty_n) as stock_in_qty_n, sum(average_stock_ledger.stock_out_qty_n) as stock_out_qty_n from kpi.tr_daily_stock_ledger as daily_stock_ledger inner join kpi.tr_daily_stock_ledger as average_stock_ledger on (daily_stock_ledger.day_id_n = (select to_number(to_char((select date 'yesterday'),'yyyymmdd'),'99999999')) and average_stock_ledger.day_id_n between (select to_char((select date 'yesterday' - interval '6 days'),'yyyymmdd')::numeric) and daily_stock_ledger.day_id_n and daily_stock_ledger.account_id_n = average_stock_ledger.account_id_n and daily_stock_ledger.node_id_n = average_stock_ledger.node_id_n and daily_stock_ledger.org_id_n = average_stock_ledger.org_id_n and daily_stock_ledger.metrics_id_n = average_stock_ledger.metrics_id_n) group by daily_stock_ledger.org_id_n, daily_stock_ledger.metrics_id_n ) as groupby_query_results inner join kpi.ms_report_org_link_hierarchy as org_link_hierarchy on (org_link_hierarchy.parent_org_id_n = 20) inner join kpi.ms_report_org_master as report_org_master on (report_org_master.org_id_n = org_link_hierarchy.child_org_id_n and report_org_master.org_id_n = groupby_query_results.org_id_n) inner join kpi.ms_report_product_master as report_product_master on (report_product_master.product_id_n = groupby_query_results.metrics_id_n) group by channel, region, area, salesarea, cluster, microcluster, additionalterritory, territoryid, suborgtype, organizationid, orgshortcode, organizationname,productbrand,producttype, productcategory, productname, productid,productextid;

1109005|1109|Remote File|Hotspot_Performance
1109029|1109|query|select 'Hotspot_Performance' as report_name, report_day_master.date_v as datetime, report_node_master.channel_category_v as channel, report_node_master.region_v as region, report_node_master.area_v as area, report_node_master.sales_area_v as salesarea, report_node_master.cluster_v as cluster, report_node_master.micro_cluster_v as microcluster, null as additionalterritory, report_node_master.org_short_code_v as territoryid, report_node_master.sub_org_type_name_v as hotspottype, report_node_master.hospot_category_v as hotspotcategory, null as hostspotradiusrange, report_node_master.org_id_n as hotspotid, report_node_master.hotspot_name_v as hotspotname, null as additionalinformation, case when(groupby_query_results.event_type_n = 2) then 'sellin' else case when(groupby_query_results.event_type_n = 3)then 'sellout' end end as transactiontype, groupby_query_results.transaction_hits as transactionhits, groupby_query_results.transaction_value as transactionvalue from (select daily_metrics_aggr.day_id_n as day_id_n, daily_metrics_aggr.event_type_n as event_type_n, daily_metrics_aggr.metrics_type_n as metrics_type_n, daily_metrics_aggr.actor_id_n as actor_id_n, daily_metrics_aggr.source_id_n as source_id_n, daily_metrics_aggr.metrics_id_n as metrics_id_n, round(sum(daily_metrics_aggr.no_of_events_n),0) as transaction_hits, round((sum(daily_metrics_aggr.dimension_2_n)/100),2) as transaction_value from kpi.tr_daily_event_metrics_aggr as daily_metrics_aggr where daily_metrics_aggr.day_id_n = (select to_number(to_char(date(now() - interval '1 day'),'yyyymmdd'),'99999999')) and daily_metrics_aggr.event_type_n in (2,3) and daily_metrics_aggr.metrics_type_n = 13 group by daily_metrics_aggr.day_id_n, daily_metrics_aggr.event_type_n, daily_metrics_aggr.metrics_type_n, daily_metrics_aggr.actor_id_n, daily_metrics_aggr.source_id_n, daily_metrics_aggr.metrics_id_n order by day_id_n desc ) as groupby_query_results inner join kpi.ms_report_node_master as report_node_master on (report_node_master.aggregation_id_n = groupby_query_results.actor_id_n and report_node_master.org_aggr_id_n = groupby_query_results.source_id_n) inner join kpi.ms_report_product_master as report_product_master on (report_product_master.product_id_n = groupby_query_results.metrics_id_n) inner join kpi.ms_report_day_master as report_day_master on (report_day_master.day_id_n = groupby_query_results.day_id_n)

1112005|1112|Remote File|Detail_Package_Activation_A
1112029|1112|query|select 'Detail_Package_Activation_A' as report_name, report_day_master.date_v as date, null as channel, report_network_master.region_v as region, report_network_master.area_v as area, report_network_master.sales_area_v as salesarea, report_network_master.cluster_v as cluster, report_network_master.micro_cluster_v as microcluster, null as additionalterritory, report_network_master.territory_code_v as territoryid, report_network_master.lac_id_v as lacid, report_network_master.cell_id_v as cellid, system_source.metrics_name_v as systemsource, null as sid, null as smstext, report_product_master.product_code_v as packagecode, report_product_master.product_name_v as packagename, groupby_query_results.activation_qty as qty, groupby_query_results.activation_value as amount from (select daily_upload_metrics_aggr.day_id_n as day_id_n, daily_upload_metrics_aggr.event_type_n as event_type_n, daily_upload_metrics_aggr.actor_id_n as actor_id_n, daily_upload_metrics_aggr.metrics_type_n as metrics_type_n, daily_upload_metrics_aggr.metrics_id_n as metrics_id_n, daily_upload_metrics_aggr.instance_id_n as instance_id_n, round(sum((daily_upload_metrics_aggr.dimension_1_n)/100),2) as activation_qty, round(sum((daily_upload_metrics_aggr.dimension_2_n)/100),2) as activation_value from kpi.tr_daily_upload_metrics_aggr as daily_upload_metrics_aggr where daily_upload_metrics_aggr.day_id_n = (select to_number(to_char(date(now() - interval '1 day'),'yyyymmdd'),'99999999')) and daily_upload_metrics_aggr.event_type_n = 104 and daily_upload_metrics_aggr.metrics_type_n in (44) group by daily_upload_metrics_aggr.day_id_n, daily_upload_metrics_aggr.event_type_n, daily_upload_metrics_aggr.actor_id_n,daily_upload_metrics_aggr.metrics_type_n, daily_upload_metrics_aggr.metrics_id_n, daily_upload_metrics_aggr.instance_id_n order by day_id_n desc ) as groupby_query_results inner join kpi.ms_report_network_master as report_network_master on (groupby_query_results.actor_id_n = report_network_master.aggregation_id_n) inner join kpi.ms_metrics_master as system_source on (groupby_query_results.instance_id_n = system_source.metrics_id_n and system_source.metrics_type_n = 31) inner join kpi.ms_report_product_master as report_product_master on (groupby_query_results.metrics_id_n = report_product_master.product_id_n) inner join kpi.ms_report_day_master as report_day_master on (groupby_query_results.day_id_n = report_day_master.day_id_n)

1113005|1113|Remote File|Detail_Package_Activation_B
1113029|1113|query|select 'Detail_Package_Activation_B' as report_name, report_day_master.date_v as date, null as channel, report_network_master.region_v as region, report_network_master.area_v as area, report_network_master.sales_area_v as salesarea, report_network_master.cluster_v as cluster, report_network_master.micro_cluster_v as microcluster, null as additionalterritory, report_network_master.territory_code_v as territoryid, report_network_master.lac_id_v as lacid, report_network_master.cell_id_v as cellid, system_source.metrics_name_v as systemsource, null as sid, null as smstext, report_product_master.product_code_v as packagecode, report_product_master.product_name_v as packagename, groupby_query_results.activation_qty as qty, groupby_query_results.activation_value as amount from (select daily_upload_metrics_aggr.day_id_n as day_id_n, daily_upload_metrics_aggr.event_type_n as event_type_n, daily_upload_metrics_aggr.actor_id_n as actor_id_n, daily_upload_metrics_aggr.metrics_type_n as metrics_type_n, daily_upload_metrics_aggr.metrics_id_n as metrics_id_n, daily_upload_metrics_aggr.instance_id_n as instance_id_n, round(sum((daily_upload_metrics_aggr.dimension_1_n)/100),2) as activation_qty, round(sum((daily_upload_metrics_aggr.dimension_2_n)/100),2) as activation_value from kpi.tr_daily_upload_metrics_aggr as daily_upload_metrics_aggr where daily_upload_metrics_aggr.day_id_n = (select to_number(to_char(date(now() - interval '1 day'),'yyyymmdd'),'99999999')) and daily_upload_metrics_aggr.actor_type_n = 8 and daily_upload_metrics_aggr.event_type_n = 105 and daily_upload_metrics_aggr.metrics_type_n in (44) group by daily_upload_metrics_aggr.day_id_n, daily_upload_metrics_aggr.event_type_n, daily_upload_metrics_aggr.actor_id_n,daily_upload_metrics_aggr.metrics_type_n, daily_upload_metrics_aggr.metrics_id_n, daily_upload_metrics_aggr.instance_id_n order by day_id_n desc ) as groupby_query_results inner join kpi.ms_report_network_master as report_network_master on (groupby_query_results.actor_id_n = report_network_master.aggregation_id_n) inner join kpi.ms_metrics_master as system_source on (groupby_query_results.instance_id_n = system_source.metrics_id_n and system_source.metrics_type_n = 31) inner join kpi.ms_report_product_master as report_product_master on (groupby_query_results.metrics_id_n = report_product_master.product_id_n) inner join kpi.ms_report_day_master as report_day_master on (groupby_query_results.day_id_n = report_day_master.day_id_n)

1124005|1124|Remote File|Summary_CS_Reload_Physical_Report
1124029|1124|query|select 'Summary_CS_Reload_Physical_Report' as report_name, report_day_master.date_v as date, report_org_master.channel_category_v as channel, report_network_master.region_v as region, report_network_master.area_v as area, report_network_master.sales_area_v as salesarea, report_network_master.cluster_v as cluster, report_network_master.micro_cluster_v as microcluster, groupby_query_results.territoryid as territoryid, null as additionalterritory, report_product_master.product_code_v as physicalproductcode, report_product_master.product_category_name_v as physicalproductcategory, report_product_master.product_name_v as physicalproductname, groupby_query_results.territorycrossellingtype as territorycrossellingtype, null as totalvalue, groupby_query_results.totalqty as totalqty, null as crossellingactivationvalue, groupby_query_results.crossellingactivationqty as crossellingactivationqty, null as inneractivationvalue, groupby_query_results.inneractivationqty as inneractivationqty from (select daily_event_metrics_aggr.day_id_n as day_id_n, daily_event_metrics_aggr.actor_id_n as actor_id_n, daily_event_metrics_aggr.event_type_n as event_type_n, daily_event_metrics_aggr.metrics_id_n as metrics_id_n, daily_event_metrics_aggr.metrics_type_n as metrics_type_n, daily_event_metrics_aggr.instance_type_n as instance_type_n, daily_event_metrics_aggr.instance_id_n as instance_id_n, daily_event_metrics_aggr.source_type_n as source_type_n, daily_event_metrics_aggr.source_id_n as source_id_n, daily_event_metrics_aggr.data_flag_n as data_flag_n, daily_crossell.instance_id_n as territorycrossellingtype, daily_crossell.instance_type_n as territoryid, round((sum(daily_not_crossell.dimension_1_n)/100),0) as inneractivationqty, round((sum(daily_crossell.dimension_1_n)/100),0) as crossellingactivationqty, round((sum(daily_event_metrics_aggr.dimension_1_n)/100),0) as totalqty from kpi.tr_daily_event_metrics_aggr as daily_event_metrics_aggr left join kpi.tr_daily_event_metrics_aggr as daily_crossell on (daily_event_metrics_aggr.day_id_n = daily_crossell.day_id_n and daily_crossell.data_flag_n in (1) ) left join kpi.tr_daily_event_metrics_aggr as daily_not_crossell on (daily_event_metrics_aggr.day_id_n = daily_not_crossell.day_id_n and daily_not_crossell.data_flag_n in (2) ) where daily_event_metrics_aggr.day_id_n = (select to_number(to_char(date(now() - interval '1 day'),'yyyymmdd'),'99999999')) and daily_event_metrics_aggr.event_type_n = 8 and daily_event_metrics_aggr.actor_type_n=8 and daily_event_metrics_aggr.metrics_type_n in (13) and daily_event_metrics_aggr.data_flag_n in (1, 2) group by daily_event_metrics_aggr.day_id_n, daily_event_metrics_aggr.actor_id_n, daily_event_metrics_aggr.event_type_n, daily_event_metrics_aggr.metrics_type_n, daily_event_metrics_aggr.metrics_id_n, daily_event_metrics_aggr.instance_type_n, daily_event_metrics_aggr.instance_id_n, daily_event_metrics_aggr.source_type_n, daily_event_metrics_aggr.source_id_n, daily_event_metrics_aggr.data_flag_n, daily_crossell.instance_id_n , daily_crossell.instance_type_n order by day_id_n desc ) as groupby_query_results inner join kpi.ms_report_org_master as report_org_master on (report_org_master.aggregation_id_n = groupby_query_results.source_id_n) inner join kpi.ms_report_product_master as report_product_master on (report_product_master.product_id_n = groupby_query_results.metrics_id_n) inner join kpi.ms_lookup_master as origin_cluster on ( groupby_query_results.instance_id_n = origin_cluster.lookup_id_n ) inner join kpi.ms_lookup_master as crossell_cluster on (groupby_query_results.instance_id_n = crossell_cluster.lookup_id_n and crossell_cluster.lookup_type_n = (select lookup_type_n from kpi.ms_lookup_master as lookup_master where lookup_master.lookup_id_n = groupby_query_results.instance_type_n)) inner join kpi.ms_report_network_master as report_network_master on ((groupby_query_results.actor_id_n = report_network_master.aggregation_id_n) or (origin_cluster.lookup_id_n = report_network_master.territory_id_n and origin_cluster.lookup_type_n = report_network_master.territory_type_n)) inner join kpi.ms_report_day_master as report_day_master on (groupby_query_results.day_id_n = report_day_master.day_id_n)

1125005|1125|Remote File|CS_Reload_Physical_Report
1125029|1125|query|select 'CS_Reload_Physical_Report' as report_name, report_day_master.date_v as date, report_org_master.channel_category_v as channel, report_network_master.region_v as region, report_network_master.area_v as area, report_network_master.sales_area_v as salesarea, report_network_master.cluster_v as cluster, report_network_master.micro_cluster_v as microcluster, groupby_query_results.instance_type_n as territoryid, null as additionalterritory, report_product_master.product_code_v as physicalproductcode, report_product_master.product_category_name_v as physicalproductcategory, report_product_master.product_name_v as physicalproductname, groupby_query_results.instance_id_n as territorycrossellingtype, report_network_master.lac_id_v as lacid, report_network_master.cell_id_v as cellid, null as targetterritoryname, null as targetterritoryid, null as totalvalue, groupby_query_results.totalqty as totalqty from (select daily_event_metrics_aggr.day_id_n as day_id_n, daily_event_metrics_aggr.actor_id_n as actor_id_n, daily_event_metrics_aggr.event_type_n as event_type_n, daily_event_metrics_aggr.metrics_id_n as metrics_id_n, daily_event_metrics_aggr.metrics_type_n as metrics_type_n, daily_event_metrics_aggr.instance_type_n as instance_type_n, daily_event_metrics_aggr.instance_id_n as instance_id_n, daily_event_metrics_aggr.source_type_n as source_type_n, daily_event_metrics_aggr.source_id_n as source_id_n, daily_event_metrics_aggr.data_flag_n as data_flag_n, round((sum(daily_event_metrics_aggr.dimension_1_n)/100),0) as totalqty from kpi.tr_daily_event_metrics_aggr as daily_event_metrics_aggr where daily_event_metrics_aggr.day_id_n = (select to_number(to_char(date(now() - interval '1 day'),'yyyymmdd'),'99999999')) and daily_event_metrics_aggr.event_type_n = 8 and daily_event_metrics_aggr.actor_type_n=8 and daily_event_metrics_aggr.metrics_type_n in (13) and daily_event_metrics_aggr.data_flag_n in (1) group by daily_event_metrics_aggr.day_id_n, daily_event_metrics_aggr.actor_id_n, daily_event_metrics_aggr.event_type_n, daily_event_metrics_aggr.metrics_type_n, daily_event_metrics_aggr.metrics_id_n, daily_event_metrics_aggr.instance_type_n, daily_event_metrics_aggr.instance_id_n, daily_event_metrics_aggr.source_type_n, daily_event_metrics_aggr.source_id_n, daily_event_metrics_aggr.data_flag_n order by day_id_n desc ) as groupby_query_results inner join kpi.ms_report_org_master as report_org_master on (report_org_master.aggregation_id_n = groupby_query_results.source_id_n) inner join kpi.ms_report_product_master as report_product_master on (report_product_master.product_id_n = groupby_query_results.metrics_id_n) inner join kpi.ms_lookup_master as origin_cluster on ( groupby_query_results.instance_id_n = origin_cluster.lookup_id_n ) inner join kpi.ms_lookup_master as crossell_cluster on (groupby_query_results.instance_id_n = crossell_cluster.lookup_id_n and crossell_cluster.lookup_type_n = (select lookup_type_n from kpi.ms_lookup_master as lookup_master where lookup_master.lookup_id_n = groupby_query_results.instance_type_n)) inner join kpi.ms_report_network_master as report_network_master on ((groupby_query_results.actor_id_n = report_network_master.aggregation_id_n) or (origin_cluster.lookup_id_n = report_network_master.territory_id_n and origin_cluster.lookup_type_n = report_network_master.territory_type_n)) inner join kpi.ms_report_day_master as report_day_master on (groupby_query_results.day_id_n = report_day_master.day_id_n)

1126005|1126|Remote File|Sum_CS_Reload_of_e_voucher
1126029|1126|query|select 'Sum_CS_Reload_of_e_voucher' as report_name, report_day_master.date_v as date, report_org_master.channel_category_v as channel, report_network_master.region_v as region, report_network_master.area_v as area, report_network_master.sales_area_v as salesarea, report_network_master.cluster_v as cluster, report_network_master.micro_cluster_v as microcluster, groupby_query_results.territoryid as territoryid, null as additionalterritory, report_product_master.product_code_v as physicalproductcode, report_product_master.product_category_name_v as physicalproductcategory, report_product_master.product_name_v as physicalproductname, groupby_query_results.territorycrossellingtype as territorycrossellingtype, null as totalqty, groupby_query_results.totalamount as totalamount, null as crossellingactivationqty, groupby_query_results.crossellingactivationamount as crossellingactivationamount, null as inneractivationqty, groupby_query_results.inneractivationamount as inneractivationamount from (select daily_upload_metrics_aggr.day_id_n as day_id_n, daily_upload_metrics_aggr.actor_id_n as actor_id_n, daily_upload_metrics_aggr.event_type_n as event_type_n, daily_upload_metrics_aggr.metrics_id_n as metrics_id_n, daily_upload_metrics_aggr.metrics_type_n as metrics_type_n, daily_upload_metrics_aggr.instance_type_n as instance_type_n, daily_upload_metrics_aggr.instance_id_n as instance_id_n, daily_upload_metrics_aggr.source_type_n as source_type_n, daily_upload_metrics_aggr.source_id_n as source_id_n, daily_upload_metrics_aggr.data_flag_n as data_flag_n, daily_crossell.instance_type_n as territoryid, daily_crossell.instance_id_n as territorycrossellingtype, round((sum(daily_upload_metrics_aggr.dimension_2_n)/100),0) as totalamount, round((sum(daily_crossell.dimension_2_n)/100),0) as crossellingactivationamount, round((sum(daily_not_crossell.dimension_2_n)/100),0) as inneractivationamount from kpi.tr_daily_upload_metrics_aggr as daily_upload_metrics_aggr left join kpi.tr_daily_upload_metrics_aggr as daily_crossell on (daily_upload_metrics_aggr.day_id_n = daily_crossell.day_id_n and daily_crossell.data_flag_n = 1 ) left join kpi.tr_daily_upload_metrics_aggr as daily_not_crossell on (daily_upload_metrics_aggr.day_id_n = daily_not_crossell.day_id_n and daily_not_crossell.data_flag_n = 2 ) where daily_upload_metrics_aggr.day_id_n = (select to_number(to_char(date(now() - interval '1 day'),'yyyymmdd'),'99999999')) and daily_upload_metrics_aggr.event_type_n = 116 and daily_upload_metrics_aggr.data_flag_n in (1, 2,3, 4) group by daily_upload_metrics_aggr.day_id_n, daily_upload_metrics_aggr.actor_id_n, daily_upload_metrics_aggr.event_type_n, daily_upload_metrics_aggr.metrics_type_n, daily_upload_metrics_aggr.metrics_id_n, daily_upload_metrics_aggr.instance_type_n, daily_upload_metrics_aggr.instance_id_n, daily_upload_metrics_aggr.source_type_n, daily_upload_metrics_aggr.source_id_n, daily_upload_metrics_aggr.data_flag_n, territorycrossellingtype, territoryid order by day_id_n desc ) as groupby_query_results inner join kpi.ms_report_org_master as report_org_master on (report_org_master.aggregation_id_n = groupby_query_results.source_id_n) inner join kpi.ms_report_product_master as report_product_master on (report_product_master.product_id_n = groupby_query_results.metrics_id_n) inner join kpi.ms_lookup_master as origin_cluster on ( groupby_query_results.territorycrossellingtype = origin_cluster.lookup_id_n ) inner join kpi.ms_lookup_master as crossell_cluster on (groupby_query_results.territorycrossellingtype = crossell_cluster.lookup_id_n and crossell_cluster.lookup_type_n = (select lookup_type_n from kpi.ms_lookup_master as lookup_master where lookup_master.lookup_id_n = groupby_query_results.territoryid)) inner join kpi.ms_report_network_master as report_network_master on ((groupby_query_results.actor_id_n = report_network_master.aggregation_id_n) or (origin_cluster.lookup_id_n = report_network_master.territory_id_n and origin_cluster.lookup_type_n = report_network_master.territory_type_n)) inner join kpi.ms_report_day_master as report_day_master on (groupby_query_results.day_id_n = report_day_master.day_id_n)

1127005|1127|Remote File|Detail_CS_Reload_of_e_voucher
1127029|1127|query|select 'Detail_CS_Reload_of_e_voucher' as report_name, report_day_master.date_v as date, report_org_master.channel_category_v as channel, report_network_master.region_v as region, report_network_master.area_v as area, report_network_master.sales_area_v as salesarea, report_network_master.cluster_v as cluster, report_network_master.micro_cluster_v as microcluster, groupby_query_results.instance_id_n as territoryid, null as additionalterritory, report_product_master.product_code_v as physicalproductcode, report_product_master.product_category_name_v as physicalproductcategory, report_product_master.product_name_v as physicalproductname, groupby_query_results.instance_type_n as territorycrossellingtype, report_network_master.lac_id_v as lacid, report_network_master.cell_id_v as cellid, case when (groupby_query_results.data_flag_n = 3) then origin_cluster.lookup_name_v else null end as bterritoryname, case when (groupby_query_results.data_flag_n = 3) then origin_cluster.lookup_id_n else null end as bterritoryid, report_day_master.date_v as date, null as totalqty, groupby_query_results.totalamount as totalamount from (select daily_upload_metrics_aggr.day_id_n as day_id_n, daily_upload_metrics_aggr.actor_id_n as actor_id_n, daily_upload_metrics_aggr.event_type_n as event_type_n, daily_upload_metrics_aggr.metrics_id_n as metrics_id_n, daily_upload_metrics_aggr.metrics_type_n as metrics_type_n, daily_upload_metrics_aggr.instance_type_n as instance_type_n, daily_upload_metrics_aggr.instance_id_n as instance_id_n, daily_upload_metrics_aggr.source_type_n as source_type_n, daily_upload_metrics_aggr.source_id_n as source_id_n, daily_upload_metrics_aggr.data_flag_n as data_flag_n, round((sum(daily_upload_metrics_aggr.dimension_2_n)/100),0) as totalamount from kpi.tr_daily_upload_metrics_aggr as daily_upload_metrics_aggr where daily_upload_metrics_aggr.day_id_n = (select to_number(to_char(date(now() - interval '1 day'),'yyyymmdd'),'99999999')) and daily_upload_metrics_aggr.event_type_n = 116 and daily_upload_metrics_aggr.data_flag_n in (1, 3) group by day_id_n, actor_id_n, event_type_n, metrics_type_n, metrics_id_n, instance_type_n, instance_id_n, source_type_n, source_id_n, data_flag_n order by day_id_n desc ) as groupby_query_results inner join kpi.ms_report_org_master as report_org_master on (report_org_master.aggregation_id_n = groupby_query_results.source_id_n) inner join kpi.ms_report_product_master as report_product_master on (report_product_master.product_id_n = groupby_query_results.metrics_id_n) inner join kpi.ms_lookup_master as origin_cluster on ( groupby_query_results.instance_id_n = origin_cluster.lookup_id_n ) inner join kpi.ms_lookup_master as crossell_cluster on (groupby_query_results.instance_id_n = crossell_cluster.lookup_id_n and crossell_cluster.lookup_type_n = (select lookup_type_n from kpi.ms_lookup_master as lookup_master where lookup_master.lookup_id_n = groupby_query_results.instance_type_n)) inner join kpi.ms_report_network_master as report_network_master on ((groupby_query_results.actor_id_n = report_network_master.aggregation_id_n and groupby_query_results.data_flag_n = 3) or (origin_cluster.lookup_id_n = report_network_master.territory_id_n and origin_cluster.lookup_type_n = report_network_master.territory_type_n)) inner join kpi.ms_report_day_master as report_day_master on (groupby_query_results.day_id_n = report_day_master.day_id_n)

1128005|1128|Remote File|Summary_CS_SP_Act
1128029|1128|query|select 'Summary_CS_SP_Act' as report_name, report_day_master.date_v as date, report_org_master.channel_category_v as channel, report_network_master.region_v as region, report_network_master.area_v as area, report_network_master.sales_area_v as salesarea, report_network_master.cluster_v as cluster, report_network_master.micro_cluster_v as microcluster, groupby_query_results.territoryid as territoryid, null as additionalterritory, report_product_master.product_code_v as physicalproductcode, report_product_master.product_category_name_v as physicalproductcategory, report_product_master.product_name_v as physicalproductname, groupby_query_results.territorycrossellingtype as territorycrossellingtype, null as totalvalue, groupby_query_results.totalqty as totalqty, null as crossellingactivationvalue, groupby_query_results.crossellingactivationqty as crossellingactivationqty, null as inneractivationvalue, groupby_query_results.inneractivationqty as inneractivationqty from (select daily_metrics_aggr.day_id_n as day_id_n, daily_metrics_aggr.actor_id_n as actor_id_n, daily_metrics_aggr.event_type_n as event_type_n, daily_metrics_aggr.metrics_id_n as metrics_id_n, daily_metrics_aggr.metrics_type_n as metrics_type_n, daily_metrics_aggr.instance_type_n as instance_type_n, daily_metrics_aggr.instance_id_n as instance_id_n, daily_metrics_aggr.source_type_n as source_type_n, daily_metrics_aggr.source_id_n as source_id_n, daily_crossell.instance_type_n as territoryid, daily_crossell.instance_id_n as territorycrossellingtype, daily_metrics_aggr.data_flag_n as data_flag_n, round((sum(daily_metrics_aggr.dimension_2_n)/100),0) as totalqty, round((sum(daily_crossell.dimension_2_n)/100),0) as crossellingactivationqty, round((sum(daily_not_crossell.dimension_2_n)/100),0) as inneractivationqty from kpi.tr_daily_event_metrics_aggr as daily_metrics_aggr left join kpi.tr_daily_event_metrics_aggr as daily_crossell on (daily_metrics_aggr.day_id_n = daily_crossell.day_id_n and daily_crossell.data_flag_n = 1 ) left join kpi.tr_daily_event_metrics_aggr as daily_not_crossell on (daily_metrics_aggr.day_id_n = daily_not_crossell.day_id_n and daily_not_crossell.data_flag_n = 2 ) where daily_metrics_aggr.day_id_n = (select to_number(to_char(date(now() - interval '1 day'),'yyyymmdd'),'99999999')) and daily_metrics_aggr.event_type_n = 6 and daily_metrics_aggr.metrics_type_n in (13) and daily_metrics_aggr.data_flag_n in (1,2) and daily_metrics_aggr.actor_type_n=8 group by daily_metrics_aggr.day_id_n, daily_metrics_aggr.actor_id_n, daily_metrics_aggr.event_type_n, daily_metrics_aggr.metrics_type_n, daily_metrics_aggr.metrics_id_n, daily_metrics_aggr.instance_type_n, daily_metrics_aggr.instance_id_n, daily_metrics_aggr.source_type_n, daily_metrics_aggr.source_id_n, daily_metrics_aggr.data_flag_n, territorycrossellingtype, territoryid order by day_id_n desc ) as groupby_query_results inner join kpi.ms_report_org_master as report_org_master on (report_org_master.aggregation_id_n = groupby_query_results.source_id_n) inner join kpi.ms_report_product_master as report_product_master on (groupby_query_results.metrics_id_n = report_product_master.product_id_n and report_product_master.product_category_id_n in (select metrics_id_n from kpi.ms_metrics_master where ext_metrics_id_v in (select unnest(string_to_array(property_value_v::text, ','::text)::character varying[]) from kpi.ms_property_master where property_key_v ilike 'starter_pack_master'))) inner join kpi.ms_lookup_master as origin_cluster on ( groupby_query_results.territorycrossellingtype = origin_cluster.lookup_id_n ) inner join kpi.ms_lookup_master as crossell_cluster on (groupby_query_results.territorycrossellingtype = crossell_cluster.lookup_id_n and crossell_cluster.lookup_type_n = (select lookup_type_n from kpi.ms_lookup_master as lookup_master where lookup_master.lookup_id_n = groupby_query_results.territoryid)) inner join kpi.ms_report_network_master as report_network_master on ((groupby_query_results.actor_id_n = report_network_master.aggregation_id_n) or (origin_cluster.lookup_id_n = report_network_master.territory_id_n and origin_cluster.lookup_type_n = report_network_master.territory_type_n)) inner join kpi.ms_report_day_master as report_day_master on (groupby_query_results.day_id_n = report_day_master.day_id_n)


