InterfaceID  --- Event ID --- Existing DailyTable --- Existing Monthly Table --- New DailyTable --- New Monthly Table


1076 --- 107 --- tr_daily_upload_metrics_aggr --- tr_monthly_upload_metrics_aggr --- tr_daily_reload_seller_aggr --- tr_monthly_reload_seller_aggr
1077 --- 108 --- tr_daily_upload_metrics_aggr --- tr_monthly_upload_metrics_aggr --- tr_daily_reload_buyer_aggr --- tr_monthly_reload_buyer_aggr
1078 --- 111 --- tr_daily_upload_metrics_aggr --- tr_monthly_upload_metrics_aggr --- tr_daily_usage_customer_aggr --- tr_monthly_usage_customer_aggr
1079 --- 112 --- tr_daily_upload_metrics_aggr --- tr_monthly_upload_metrics_aggr --- tr_daily_addon_customer_aggr --- tr_monthly_addon_customer_aggr
1080 --- 109 --- tr_daily_upload_metrics_aggr --- tr_monthly_upload_metrics_aggr --- tr_daily_reload_customer_aggr --- tr_monthly_reload_customer_aggr
1081 --- 110 --- tr_daily_upload_metrics_aggr --- tr_monthly_upload_metrics_aggr --- tr_daily_reload_sellinout_aggr --- tr_monthly_reload_sellinout_aggr

=============================================================================================
Old one
=============================================================================================
1076039|1076|Field Lookup Conf|{"fields":{"actor_field":"CI ID","metric_field":"Product Value","source_field":"Org Id","instance_field":"Reload system"},"error_codes":{"actor_field":"60102","metric_field":"60201","source_field":"60301","instance_field":"60401"},"lacci_mapping":{"CI ID":"LAC ID~CI ID"},"table_name":"tr_temp_upload_metrics_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_master(?, ?);","notexist_lookup":"metrics","no_of_params":{"metrics":2},"reprocess":{"event_type":107,"error_code":60102},"daily_table":"tr_daily_upload_metrics_aggr","monthly_table":"tr_monthly_upload_metrics_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}
1077039|1077|Field Lookup Conf|{"fields":{"actor_field":"CI ID","metric_field":"Product Value","source_field":"","instance_field":"Reload system"},"error_codes":{"actor_field":"60102","metric_field":"60201","source_field":"60301","instance_field":"60401"},"lacci_mapping":{"CI ID":"LAC ID~CI ID"},"table_name":"tr_temp_upload_metrics_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_master(?, ?);","notexist_lookup":"metrics","no_of_params":{"metrics":2},"reprocess":{"event_type":108,"error_code":60102},"daily_table":"tr_daily_upload_metrics_aggr","monthly_table":"tr_monthly_upload_metrics_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}
1078041|1078|Field Lookup Conf|{"fields":{"actor_field":"B#MSISDN","metric_field":"B#MSISDN","source_field":"OperatorID","instance_field":""},"error_codes":{"actor_field":"60101","metric_field":"60201","source_field":"60301","instance_field":"60401"},"table_name":"tr_temp_upload_metrics_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_master(?, ?);","notexist_lookup":"actor","no_of_params":{"actor":1},"daily_table":"tr_daily_upload_metrics_aggr","monthly_table":"tr_monthly_upload_metrics_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}
1079040|1079|Field Lookup Conf|{"fields":{"actor_field":"B#MSISDN","metric_field":"PACKAGE_NAME","source_field":"OperatorID","instance_field":""},"error_codes":{"actor_field":"60101","metric_field":"60201","source_field":"60301","instance_field":"60401"},"table_name":"tr_temp_upload_metrics_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_master(?, ?);","notexist_lookup":"actor","no_of_params":{"actor":1},"daily_table":"tr_daily_upload_metrics_aggr","monthly_table":"tr_monthly_upload_metrics_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}
1080041|1080|Field Lookup Conf|{"fields":{"actor_field":"B#MSISDN","metric_field":"B#MSISDN","source_field":"OperatorID","instance_field":""},"error_codes":{"actor_field":"60101","metric_field":"60201","source_field":"60301","instance_field":"60401"},"table_name":"tr_temp_upload_metrics_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_master(?, ?);","notexist_lookup":"actor","no_of_params":{"actor":1},"daily_table":"tr_daily_upload_metrics_aggr","monthly_table":"tr_monthly_upload_metrics_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}
1081039|1081|Field Lookup Conf|{"fields":{"actor_field":"Organization code","metric_field":"","source_field":"Organization code","instance_field":""},"error_codes":{"actor_field":"60101","metric_field":"60201","source_field":"60301","instance_field":"60401"},"table_name":"tr_temp_upload_metrics_direct_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_direct_master(?, ?);","daily_table":"tr_daily_upload_metrics_aggr","monthly_table":"tr_monthly_upload_metrics_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}

=============================================================================================
New one
=============================================================================================
1076039|1076|Field Lookup Conf|{"fields":{"actor_field":"CI ID","metric_field":"Product Value","source_field":"Org Id","instance_field":"Reload system"},"error_codes":{"actor_field":"60102","metric_field":"60201","source_field":"60301","instance_field":"60401"},"lacci_mapping":{"CI ID":"LAC ID~CI ID"},"table_name":"tr_temp_upload_metrics_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_master(?, ?);","notexist_lookup":"metrics","no_of_params":{"metrics":2},"reprocess":{"event_type":107,"error_code":60102},"daily_table":"tr_daily_reload_seller_aggr","monthly_table":"tr_monthly_reload_seller_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}
1077039|1077|Field Lookup Conf|{"fields":{"actor_field":"CI ID","metric_field":"Product Value","source_field":"","instance_field":"Reload system"},"error_codes":{"actor_field":"60102","metric_field":"60201","source_field":"60301","instance_field":"60401"},"lacci_mapping":{"CI ID":"LAC ID~CI ID"},"table_name":"tr_temp_upload_metrics_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_master(?, ?);","notexist_lookup":"metrics","no_of_params":{"metrics":2},"reprocess":{"event_type":108,"error_code":60102},"daily_table":"tr_daily_reload_buyer_aggr","monthly_table":"tr_monthly_reload_buyer_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}
1078041|1078|Field Lookup Conf|{"fields":{"actor_field":"B#MSISDN","metric_field":"B#MSISDN","source_field":"OperatorID","instance_field":""},"error_codes":{"actor_field":"60101","metric_field":"60201","source_field":"60301","instance_field":"60401"},"table_name":"tr_temp_upload_metrics_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_master(?, ?);","notexist_lookup":"actor","no_of_params":{"actor":1},"daily_table":"tr_daily_usage_customer_aggr","monthly_table":"tr_monthly_usage_customer_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}
1079040|1079|Field Lookup Conf|{"fields":{"actor_field":"B#MSISDN","metric_field":"PACKAGE_NAME","source_field":"OperatorID","instance_field":""},"error_codes":{"actor_field":"60101","metric_field":"60201","source_field":"60301","instance_field":"60401"},"table_name":"tr_temp_upload_metrics_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_master(?, ?);","notexist_lookup":"actor","no_of_params":{"actor":1},"daily_table":"tr_daily_addon_customer_aggr","monthly_table":"tr_monthly_addon_customer_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}
1080041|1080|Field Lookup Conf|{"fields":{"actor_field":"B#MSISDN","metric_field":"B#MSISDN","source_field":"OperatorID","instance_field":""},"error_codes":{"actor_field":"60101","metric_field":"60201","source_field":"60301","instance_field":"60401"},"table_name":"tr_temp_upload_metrics_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_master(?, ?);","notexist_lookup":"actor","no_of_params":{"actor":1},"daily_table":"tr_daily_reload_customer_aggr","monthly_table":"tr_monthly_reload_customer_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}
1081039|1081|Field Lookup Conf|{"fields":{"actor_field":"Organization code","metric_field":"","source_field":"Organization code","instance_field":""},"error_codes":{"actor_field":"60101","metric_field":"60201","source_field":"60301","instance_field":"60401"},"table_name":"tr_temp_upload_metrics_direct_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_direct_master(?, ?);","daily_table":"tr_daily_reload_sellinout_aggr","monthly_table":"tr_monthly_reload_sellinout_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}

===============================================================================================================================
UPDATE QUERY
===============================================================================================================================

UPDATE interface.ms_interface_attr SET value_v = '{"fields":{"actor_field":"CI ID","metric_field":"Product Value","source_field":"Org Id","instance_field":"Reload system"},"error_codes":{"actor_field":"60102","metric_field":"60201","source_field":"60301","instance_field":"60401"},"lacci_mapping":{"CI ID":"LAC ID~CI ID"},"table_name":"tr_temp_upload_metrics_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_master(?, ?);","notexist_lookup":"metrics","no_of_params":{"metrics":2},"reprocess":{"event_type":107,"error_code":60102},"daily_table":"tr_daily_reload_seller_aggr","monthly_table":"tr_monthly_reload_seller_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}' where attribute_id_n = 1076039;
UPDATE interface.ms_interface_attr SET value_v = '{"fields":{"actor_field":"CI ID","metric_field":"Product Value","source_field":"","instance_field":"Reload system"},"error_codes":{"actor_field":"60102","metric_field":"60201","source_field":"60301","instance_field":"60401"},"lacci_mapping":{"CI ID":"LAC ID~CI ID"},"table_name":"tr_temp_upload_metrics_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_master(?, ?);","notexist_lookup":"metrics","no_of_params":{"metrics":2},"reprocess":{"event_type":108,"error_code":60102},"daily_table":"tr_daily_reload_buyer_aggr","monthly_table":"tr_monthly_reload_buyer_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}' where attribute_id_n = 1077039;
UPDATE interface.ms_interface_attr SET value_v = '{"fields":{"actor_field":"B#MSISDN","metric_field":"B#MSISDN","source_field":"OperatorID","instance_field":""},"error_codes":{"actor_field":"60101","metric_field":"60201","source_field":"60301","instance_field":"60401"},"table_name":"tr_temp_upload_metrics_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_master(?, ?);","notexist_lookup":"actor","no_of_params":{"actor":1},"daily_table":"tr_daily_usage_customer_aggr","monthly_table":"tr_monthly_usage_customer_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}' where attribute_id_n = 1078041;
UPDATE interface.ms_interface_attr SET value_v = '{"fields":{"actor_field":"B#MSISDN","metric_field":"PACKAGE_NAME","source_field":"OperatorID","instance_field":""},"error_codes":{"actor_field":"60101","metric_field":"60201","source_field":"60301","instance_field":"60401"},"table_name":"tr_temp_upload_metrics_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_master(?, ?);","notexist_lookup":"actor","no_of_params":{"actor":1},"daily_table":"tr_daily_addon_customer_aggr","monthly_table":"tr_monthly_addon_customer_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}' where attribute_id_n = 1079040;
UPDATE interface.ms_interface_attr SET value_v = '{"fields":{"actor_field":"B#MSISDN","metric_field":"B#MSISDN","source_field":"OperatorID","instance_field":""},"error_codes":{"actor_field":"60101","metric_field":"60201","source_field":"60301","instance_field":"60401"},"table_name":"tr_temp_upload_metrics_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_master(?, ?);","notexist_lookup":"actor","no_of_params":{"actor":1},"daily_table":"tr_daily_reload_customer_aggr","monthly_table":"tr_monthly_reload_customer_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}' where attribute_id_n = 1080041;
UPDATE interface.ms_interface_attr SET value_v = '{"fields":{"actor_field":"Organization code","metric_field":"","source_field":"Organization code","instance_field":""},"error_codes":{"actor_field":"60101","metric_field":"60201","source_field":"60301","instance_field":"60401"},"table_name":"tr_temp_upload_metrics_direct_aggr","lookup_query":"select * from kpi.update_aggregate_lookup_direct_master(?, ?);","daily_table":"tr_daily_reload_sellinout_aggr","monthly_table":"tr_monthly_reload_sellinout_aggr","no_of_join_query_params":1,"no_of_daily_join_queries":1,"no_of_monthly_join_queries":1}' where attribute_id_n = 1081039;

=============================================================================================================================
OLD queries.properties 1076-1081
=============================================================================================================================
1076_DAILY_JOIN_QUERY_1=SELECT 1076 as interface_id_n, temp1.id_n, daily1.day_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND daily1.dimension_1_n IS NULL) THEN NULL ELSE ( COALESCE(temp1.dimension_1_n, 0) + COALESCE(daily1.dimension_1_n, 0) ) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND daily1.dimension_2_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_2_n, 0) + COALESCE(daily1.dimension_2_n, 0) ) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND daily1.dimension_3_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_3_n, 0) + COALESCE(daily1.dimension_3_n, 0) ) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND daily1.dimension_4_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_4_n, 0) + COALESCE(daily1.dimension_4_n, 0) ) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND daily1.dimension_5_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_5_n, 0) + COALESCE(daily1.dimension_5_n, 0) ) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND daily1.dimension_6_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_6_n, 0) + COALESCE(daily1.dimension_6_n, 0) ) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND daily1.dimension_7_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_7_n, 0) + COALESCE(daily1.dimension_7_n, 0) ) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND daily1.dimension_8_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_8_n, 0) + COALESCE(daily1.dimension_8_n, 0) ) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND daily1.dimension_9_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_9_n, 0) + COALESCE(daily1.dimension_9_n, 0) ) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND daily1.dimension_10_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_10_n, 0) + COALESCE(daily1.dimension_10_n, 0) ) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND daily1.no_of_events_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.no_of_events_n, 0) + COALESCE(daily1.no_of_events_n, 0) ) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT temp.id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(nm.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dorg.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.instance_type_n), temp.instance_type_n) as instance_type_n, COALESCE(imet.metrics_id_n, 0) AS instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(nm.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dorg.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) WHEN temp.instance_key_v IS NOT NULL AND COALESCE(imet.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'instance_field%Instance mapping not found for instance_field : ' || temp.instance_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.ms_network_master nm ON temp.actor_key_v = nm.lacci_id_v LEFT JOIN kpi.ms_metrics_master met ON ( temp.metrics_key_v = met.ext_reference_id_v AND met.metrics_type_n = 30 ) LEFT JOIN kpi.ms_org_master dorg ON temp.source_key_v = dorg.ref_code_v LEFT JOIN kpi.ms_metrics_master imet ON ( temp.instance_key_v = imet.ext_reference_id_v AND imet.metrics_type_n = 38 ) WHERE temp.file_id_n = ? ) result where result.id_flag = 1 GROUP BY result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_daily_upload_metrics_aggr daily1 ON temp1.id_n = daily1.day_id_n AND temp1.actor_type_n = daily1.actor_type_n AND temp1.actor_id_n = daily1.actor_id_n AND temp1.event_type_n = daily1.event_type_n AND temp1.metrics_type_n = daily1.metrics_type_n AND temp1.metrics_id_n = daily1.metrics_id_n AND temp1.source_type_n = daily1.source_type_n AND temp1.source_id_n = daily1.source_id_n AND temp1.data_flag_n = daily1.data_flag_n AND temp1.instance_type_n = daily1.instance_type_n AND temp1.instance_id_n = daily1.instance_id_n
1076_MONTHLY_JOIN_QUERY_1=SELECT 1076 as interface_id_n, temp1.month_id_n AS id_n, monthly1.month_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND monthly1.dimension_1_n IS NULL) THEN NULL ELSE ( COALESCE(temp1.dimension_1_n, 0) + COALESCE(monthly1.dimension_1_n, 0) ) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND monthly1.dimension_2_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_2_n, 0) + COALESCE(monthly1.dimension_2_n, 0) ) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND monthly1.dimension_3_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_3_n, 0) + COALESCE(monthly1.dimension_3_n, 0) ) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND monthly1.dimension_4_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_4_n, 0) + COALESCE(monthly1.dimension_4_n, 0) ) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND monthly1.dimension_5_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_5_n, 0) + COALESCE(monthly1.dimension_5_n, 0) ) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND monthly1.dimension_6_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_6_n, 0) + COALESCE(monthly1.dimension_6_n, 0) ) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND monthly1.dimension_7_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_7_n, 0) + COALESCE(monthly1.dimension_7_n, 0) ) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND monthly1.dimension_8_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_8_n, 0) + COALESCE(monthly1.dimension_8_n, 0) ) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND monthly1.dimension_9_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_9_n, 0) + COALESCE(monthly1.dimension_9_n, 0) ) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND monthly1.dimension_10_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_10_n, 0) + COALESCE(monthly1.dimension_10_n, 0) ) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND monthly1.no_of_events_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.no_of_events_n, 0) + COALESCE(monthly1.no_of_events_n, 0) ) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT day_master.month_id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(nm.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dorg.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.instance_type_n), temp.instance_type_n) as instance_type_n, COALESCE(imet.metrics_id_n, 0) AS instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(nm.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dorg.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) WHEN temp.instance_key_v IS NOT NULL AND COALESCE(imet.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'instance_field%Instance mapping not found for instance_field : ' || temp.instance_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.ms_network_master nm ON temp.actor_key_v = nm.lacci_id_v LEFT JOIN kpi.ms_metrics_master met ON ( temp.metrics_key_v = met.ext_reference_id_v AND met.metrics_type_n = 30 ) LEFT JOIN kpi.ms_org_master dorg ON temp.source_key_v = dorg.ref_code_v LEFT JOIN kpi.ms_metrics_master imet ON ( temp.instance_key_v = imet.ext_reference_id_v AND imet.metrics_type_n = 38 ) INNER JOIN kpi.ms_day_master AS day_master ON ( temp.id_n = day_master.day_id_n ) WHERE temp.file_id_n = ? and temp.status_flag_n = 0 ) result where result.id_flag = 1 GROUP BY result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_monthly_upload_metrics_aggr monthly1 ON temp1.month_id_n = monthly1.month_id_n AND temp1.actor_type_n = monthly1.actor_type_n AND temp1.actor_id_n = monthly1.actor_id_n AND temp1.event_type_n = monthly1.event_type_n AND temp1.metrics_type_n = monthly1.metrics_type_n AND temp1.metrics_id_n = monthly1.metrics_id_n AND temp1.source_type_n = monthly1.source_type_n AND temp1.source_id_n = monthly1.source_id_n AND temp1.data_flag_n = monthly1.data_flag_n AND temp1.instance_type_n = monthly1.instance_type_n AND temp1.instance_id_n = monthly1.instance_id_n
1077_DAILY_JOIN_QUERY_1=SELECT 1077 as interface_id_n, temp1.id_n, daily1.day_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND daily1.dimension_1_n IS NULL) THEN NULL ELSE ( COALESCE(temp1.dimension_1_n, 0) + COALESCE(daily1.dimension_1_n, 0) ) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND daily1.dimension_2_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_2_n, 0) + COALESCE(daily1.dimension_2_n, 0) ) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND daily1.dimension_3_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_3_n, 0) + COALESCE(daily1.dimension_3_n, 0) ) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND daily1.dimension_4_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_4_n, 0) + COALESCE(daily1.dimension_4_n, 0) ) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND daily1.dimension_5_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_5_n, 0) + COALESCE(daily1.dimension_5_n, 0) ) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND daily1.dimension_6_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_6_n, 0) + COALESCE(daily1.dimension_6_n, 0) ) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND daily1.dimension_7_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_7_n, 0) + COALESCE(daily1.dimension_7_n, 0) ) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND daily1.dimension_8_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_8_n, 0) + COALESCE(daily1.dimension_8_n, 0) ) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND daily1.dimension_9_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_9_n, 0) + COALESCE(daily1.dimension_9_n, 0) ) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND daily1.dimension_10_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_10_n, 0) + COALESCE(daily1.dimension_10_n, 0) ) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND daily1.no_of_events_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.no_of_events_n, 0) + COALESCE(daily1.no_of_events_n, 0) ) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT temp.id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(nm.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, temp.source_type_n, temp.source_id_n, temp.data_flag_n, temp.instance_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.instance_type_n), temp.instance_type_n) as instance_type_n, COALESCE(imet.metrics_id_n, 0) AS instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(nm.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.instance_key_v IS NOT NULL AND COALESCE(imet.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'instance_field%Instance mapping not found for instance_field : ' || temp.instance_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.ms_network_master nm ON temp.actor_key_v = nm.lacci_id_v LEFT JOIN kpi.ms_metrics_master met ON ( temp.metrics_key_v = met.ext_reference_id_v AND met.metrics_type_n = 30 ) LEFT JOIN kpi.ms_metrics_master imet ON ( temp.instance_key_v = imet.ext_reference_id_v AND imet.metrics_type_n = 38 ) WHERE temp.file_id_n = ? ) result where result.id_flag = 1 GROUP BY result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_daily_upload_metrics_aggr daily1 ON temp1.id_n = daily1.day_id_n AND temp1.actor_type_n = daily1.actor_type_n AND temp1.actor_id_n = daily1.actor_id_n AND temp1.event_type_n = daily1.event_type_n AND temp1.metrics_type_n = daily1.metrics_type_n AND temp1.metrics_id_n = daily1.metrics_id_n AND temp1.source_type_n = daily1.source_type_n AND temp1.source_id_n = daily1.source_id_n AND temp1.data_flag_n = daily1.data_flag_n AND temp1.instance_type_n = daily1.instance_type_n AND temp1.instance_id_n = daily1.instance_id_n
1077_MONTHLY_JOIN_QUERY_1=SELECT 1077 as interface_id_n, temp1.month_id_n AS id_n, monthly1.month_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND monthly1.dimension_1_n IS NULL) THEN NULL ELSE ( COALESCE(temp1.dimension_1_n, 0) + COALESCE(monthly1.dimension_1_n, 0) ) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND monthly1.dimension_2_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_2_n, 0) + COALESCE(monthly1.dimension_2_n, 0) ) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND monthly1.dimension_3_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_3_n, 0) + COALESCE(monthly1.dimension_3_n, 0) ) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND monthly1.dimension_4_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_4_n, 0) + COALESCE(monthly1.dimension_4_n, 0) ) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND monthly1.dimension_5_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_5_n, 0) + COALESCE(monthly1.dimension_5_n, 0) ) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND monthly1.dimension_6_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_6_n, 0) + COALESCE(monthly1.dimension_6_n, 0) ) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND monthly1.dimension_7_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_7_n, 0) + COALESCE(monthly1.dimension_7_n, 0) ) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND monthly1.dimension_8_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_8_n, 0) + COALESCE(monthly1.dimension_8_n, 0) ) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND monthly1.dimension_9_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_9_n, 0) + COALESCE(monthly1.dimension_9_n, 0) ) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND monthly1.dimension_10_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_10_n, 0) + COALESCE(monthly1.dimension_10_n, 0) ) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND monthly1.no_of_events_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.no_of_events_n, 0) + COALESCE(monthly1.no_of_events_n, 0) ) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT day_master.month_id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(nm.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, temp.source_type_n, temp.source_id_n, temp.data_flag_n, temp.instance_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.instance_type_n), temp.instance_type_n) as instance_type_n, COALESCE(imet.metrics_id_n, 0) AS instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(nm.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.instance_key_v IS NOT NULL AND COALESCE(imet.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'instance_field%Instance mapping not found for instance_field : ' || temp.instance_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.ms_network_master nm ON temp.actor_key_v = nm.lacci_id_v LEFT JOIN kpi.ms_metrics_master met ON ( temp.metrics_key_v = met.ext_reference_id_v AND met.metrics_type_n = 30 ) LEFT JOIN kpi.ms_metrics_master imet ON ( temp.instance_key_v = imet.ext_reference_id_v AND imet.metrics_type_n = 38 ) INNER JOIN kpi.ms_day_master AS day_master ON ( temp.id_n = day_master.day_id_n ) WHERE temp.file_id_n = ? and temp.status_flag_n = 0 ) result where result.id_flag = 1 GROUP BY result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_monthly_upload_metrics_aggr monthly1 ON temp1.month_id_n = monthly1.month_id_n AND temp1.actor_type_n = monthly1.actor_type_n AND temp1.actor_id_n = monthly1.actor_id_n AND temp1.event_type_n = monthly1.event_type_n AND temp1.metrics_type_n = monthly1.metrics_type_n AND temp1.metrics_id_n = monthly1.metrics_id_n AND temp1.source_type_n = monthly1.source_type_n AND temp1.source_id_n = monthly1.source_id_n AND temp1.data_flag_n = monthly1.data_flag_n AND temp1.instance_type_n = monthly1.instance_type_n AND temp1.instance_id_n = monthly1.instance_id_n
1078_DAILY_JOIN_QUERY_1=SELECT 1078 as interface_id_n, temp1.id_n, daily1.day_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND daily1.dimension_1_n IS NULL) THEN NULL ELSE (COALESCE(temp1.dimension_1_n, 0) + COALESCE(daily1.dimension_1_n, 0)) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND daily1.dimension_2_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_2_n, 0) + COALESCE(daily1.dimension_2_n, 0)) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND daily1.dimension_3_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_3_n, 0) + COALESCE(daily1.dimension_3_n, 0)) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND daily1.dimension_4_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_4_n, 0) + COALESCE(daily1.dimension_4_n, 0)) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND daily1.dimension_5_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_5_n, 0) + COALESCE(daily1.dimension_5_n, 0)) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND daily1.dimension_6_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_6_n, 0) + COALESCE(daily1.dimension_6_n, 0)) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND daily1.dimension_7_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_7_n, 0) + COALESCE(daily1.dimension_7_n, 0)) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND daily1.dimension_8_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_8_n, 0) + COALESCE(daily1.dimension_8_n, 0)) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND daily1.dimension_9_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_9_n, 0) + COALESCE(daily1.dimension_9_n, 0)) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND daily1.dimension_10_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_10_n, 0) + COALESCE(daily1.dimension_10_n, 0)) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND daily1.no_of_events_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.no_of_events_n, 0) + COALESCE(daily1.no_of_events_n, 0)) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT temp.id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(am.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dusr.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(am.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dusr.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.tr_msisdn_product_mapping mp on temp.metrics_key_v = mp.msisdn_v LEFT JOIN kpi.ms_actor_master am ON (am.actor_type_n = 7 and am.actor_id_v = temp.actor_key_v) LEFT JOIN kpi.ms_metrics_master met ON ( mp.prd_id_v = met.ext_metrics_id_v AND met.metrics_type_n = 13) LEFT JOIN kpi.ms_user_master dusr ON temp.source_key_v = dusr.operator_id_v WHERE temp.file_id_n = ? ) result where result.id_flag = 1 GROUP BY result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_daily_upload_metrics_aggr daily1 ON temp1.id_n = daily1.day_id_n AND temp1.actor_type_n = daily1.actor_type_n AND temp1.actor_id_n = daily1.actor_id_n AND temp1.event_type_n = daily1.event_type_n AND temp1.metrics_type_n = daily1.metrics_type_n AND temp1.metrics_id_n = daily1.metrics_id_n AND temp1.source_type_n = daily1.source_type_n AND temp1.source_id_n = daily1.source_id_n AND temp1.data_flag_n = daily1.data_flag_n AND temp1.instance_type_n = daily1.instance_type_n AND temp1.instance_id_n = daily1.instance_id_n
1078_MONTHLY_JOIN_QUERY_1=SELECT 1078 as interface_id_n, temp1.month_id_n AS id_n, monthly1.month_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND monthly1.dimension_1_n IS NULL) THEN NULL ELSE (COALESCE(temp1.dimension_1_n, 0) + COALESCE(monthly1.dimension_1_n, 0)) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND monthly1.dimension_2_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_2_n, 0) + COALESCE(monthly1.dimension_2_n, 0)) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND monthly1.dimension_3_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_3_n, 0) + COALESCE(monthly1.dimension_3_n, 0)) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND monthly1.dimension_4_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_4_n, 0) + COALESCE(monthly1.dimension_4_n, 0)) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND monthly1.dimension_5_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_5_n, 0) + COALESCE(monthly1.dimension_5_n, 0)) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND monthly1.dimension_6_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_6_n, 0) + COALESCE(monthly1.dimension_6_n, 0)) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND monthly1.dimension_7_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_7_n, 0) + COALESCE(monthly1.dimension_7_n, 0)) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND monthly1.dimension_8_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_8_n, 0) + COALESCE(monthly1.dimension_8_n, 0)) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND monthly1.dimension_9_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_9_n, 0) + COALESCE(monthly1.dimension_9_n, 0)) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND monthly1.dimension_10_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_10_n, 0) + COALESCE(monthly1.dimension_10_n, 0)) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND monthly1.no_of_events_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.no_of_events_n, 0) + COALESCE(monthly1.no_of_events_n, 0)) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT day_master.month_id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(am.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dusr.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(am.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dusr.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.tr_msisdn_product_mapping mp on temp.metrics_key_v = mp.msisdn_v LEFT JOIN kpi.ms_actor_master am ON (am.actor_type_n = 7 and am.actor_id_v = temp.actor_key_v) LEFT JOIN kpi.ms_metrics_master met ON ( mp.prd_id_v = met.ext_metrics_id_v AND met.metrics_type_n = 13) LEFT JOIN kpi.ms_user_master dusr ON temp.source_key_v = dusr.operator_id_v INNER JOIN kpi.ms_day_master AS day_master ON ( temp.id_n = day_master.day_id_n ) WHERE temp.file_id_n = ? and temp.status_flag_n = 0 ) result where result.id_flag = 1 GROUP BY result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_monthly_upload_metrics_aggr monthly1 ON temp1.month_id_n = monthly1.month_id_n AND temp1.actor_type_n = monthly1.actor_type_n AND temp1.actor_id_n = monthly1.actor_id_n AND temp1.event_type_n = monthly1.event_type_n AND temp1.metrics_type_n = monthly1.metrics_type_n AND temp1.metrics_id_n = monthly1.metrics_id_n AND temp1.source_type_n = monthly1.source_type_n AND temp1.source_id_n = monthly1.source_id_n AND temp1.data_flag_n = monthly1.data_flag_n AND temp1.instance_type_n = monthly1.instance_type_n AND temp1.instance_id_n = monthly1.instance_id_n
1079_DAILY_JOIN_QUERY_1=SELECT 1079 as interface_id_n, temp1.id_n, daily1.day_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND daily1.dimension_1_n IS NULL) THEN NULL ELSE (COALESCE(temp1.dimension_1_n, 0) + COALESCE(daily1.dimension_1_n, 0)) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND daily1.dimension_2_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_2_n, 0) + COALESCE(daily1.dimension_2_n, 0)) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND daily1.dimension_3_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_3_n, 0) + COALESCE(daily1.dimension_3_n, 0)) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND daily1.dimension_4_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_4_n, 0) + COALESCE(daily1.dimension_4_n, 0)) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND daily1.dimension_5_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_5_n, 0) + COALESCE(daily1.dimension_5_n, 0)) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND daily1.dimension_6_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_6_n, 0) + COALESCE(daily1.dimension_6_n, 0)) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND daily1.dimension_7_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_7_n, 0) + COALESCE(daily1.dimension_7_n, 0)) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND daily1.dimension_8_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_8_n, 0) + COALESCE(daily1.dimension_8_n, 0)) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND daily1.dimension_9_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_9_n, 0) + COALESCE(daily1.dimension_9_n, 0)) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND daily1.dimension_10_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_10_n, 0) + COALESCE(daily1.dimension_10_n, 0)) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND daily1.no_of_events_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.no_of_events_n, 0) + COALESCE(daily1.no_of_events_n, 0)) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT temp.id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(am.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dusr.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(am.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dusr.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.tr_msisdn_product_mapping mp on temp.actor_key_v = mp.msisdn_v LEFT JOIN kpi.ms_actor_master am ON (am.actor_type_n = 7 and am.actor_id_v = mp.msisdn_v) LEFT JOIN kpi.ms_metrics_master met ON ( temp.metrics_key_v = met.metrics_name_v AND met.metrics_type_n = 13 AND status_n IN ( 1, 174 ) ) LEFT JOIN kpi.ms_user_master dusr ON temp.source_key_v = dusr.operator_id_v WHERE temp.file_id_n = ? ) result where result.id_flag = 1 GROUP BY result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_daily_upload_metrics_aggr daily1 ON temp1.id_n = daily1.day_id_n AND temp1.actor_type_n = daily1.actor_type_n AND temp1.actor_id_n = daily1.actor_id_n AND temp1.event_type_n = daily1.event_type_n AND temp1.metrics_type_n = daily1.metrics_type_n AND temp1.metrics_id_n = daily1.metrics_id_n AND temp1.source_type_n = daily1.source_type_n AND temp1.source_id_n = daily1.source_id_n AND temp1.data_flag_n = daily1.data_flag_n AND temp1.instance_type_n = daily1.instance_type_n AND temp1.instance_id_n = daily1.instance_id_n
1079_MONTHLY_JOIN_QUERY_1=SELECT 1079 as interface_id_n, temp1.month_id_n AS id_n, monthly1.month_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND monthly1.dimension_1_n IS NULL) THEN NULL ELSE (COALESCE(temp1.dimension_1_n, 0) + COALESCE(monthly1.dimension_1_n, 0)) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND monthly1.dimension_2_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_2_n, 0) + COALESCE(monthly1.dimension_2_n, 0) ) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND monthly1.dimension_3_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_3_n, 0) + COALESCE(monthly1.dimension_3_n, 0) ) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND monthly1.dimension_4_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_4_n, 0) + COALESCE(monthly1.dimension_4_n, 0) ) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND monthly1.dimension_5_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_5_n, 0) + COALESCE(monthly1.dimension_5_n, 0) ) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND monthly1.dimension_6_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_6_n, 0) + COALESCE(monthly1.dimension_6_n, 0) ) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND monthly1.dimension_7_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_7_n, 0) + COALESCE(monthly1.dimension_7_n, 0) ) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND monthly1.dimension_8_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_8_n, 0) + COALESCE(monthly1.dimension_8_n, 0) ) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND monthly1.dimension_9_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_9_n, 0) + COALESCE(monthly1.dimension_9_n, 0) ) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND monthly1.dimension_10_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_10_n, 0) + COALESCE(monthly1.dimension_10_n, 0) ) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND monthly1.no_of_events_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.no_of_events_n, 0) + COALESCE(monthly1.no_of_events_n, 0) ) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT day_master.month_id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(am.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dusr.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(am.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dusr.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.tr_msisdn_product_mapping mp on temp.actor_key_v = mp.msisdn_v LEFT JOIN kpi.ms_actor_master am ON (am.actor_type_n = 7 and am.actor_id_v = mp.msisdn_v) LEFT JOIN kpi.ms_metrics_master met ON ( temp.metrics_key_v = met.metrics_name_v AND met.metrics_type_n = 13 AND status_n IN ( 1, 174 ) ) LEFT JOIN kpi.ms_user_master dusr ON temp.source_key_v = dusr.operator_id_v INNER JOIN kpi.ms_day_master AS day_master ON ( temp.id_n = day_master.day_id_n ) WHERE temp.file_id_n = ? and temp.status_flag_n = 0 ) result where result.id_flag = 1 GROUP BY result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_monthly_upload_metrics_aggr monthly1 ON temp1.month_id_n = monthly1.month_id_n AND temp1.actor_type_n = monthly1.actor_type_n AND temp1.actor_id_n = monthly1.actor_id_n AND temp1.event_type_n = monthly1.event_type_n AND temp1.metrics_type_n = monthly1.metrics_type_n AND temp1.metrics_id_n = monthly1.metrics_id_n AND temp1.source_type_n = monthly1.source_type_n AND temp1.source_id_n = monthly1.source_id_n AND temp1.data_flag_n = monthly1.data_flag_n AND temp1.instance_type_n = monthly1.instance_type_n AND temp1.instance_id_n = monthly1.instance_id_n
1080_DAILY_JOIN_QUERY_1=SELECT 1080 as interface_id_n, temp1.id_n, daily1.day_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND daily1.dimension_1_n IS NULL) THEN NULL ELSE (COALESCE(temp1.dimension_1_n, 0) + COALESCE(daily1.dimension_1_n, 0)) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND daily1.dimension_2_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_2_n, 0) + COALESCE(daily1.dimension_2_n, 0)) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND daily1.dimension_3_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_3_n, 0) + COALESCE(daily1.dimension_3_n, 0)) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND daily1.dimension_4_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_4_n, 0) + COALESCE(daily1.dimension_4_n, 0)) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND daily1.dimension_5_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_5_n, 0) + COALESCE(daily1.dimension_5_n, 0)) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND daily1.dimension_6_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_6_n, 0) + COALESCE(daily1.dimension_6_n, 0)) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND daily1.dimension_7_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_7_n, 0) + COALESCE(daily1.dimension_7_n, 0)) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND daily1.dimension_8_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_8_n, 0) + COALESCE(daily1.dimension_8_n, 0)) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND daily1.dimension_9_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_9_n, 0) + COALESCE(daily1.dimension_9_n, 0)) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND daily1.dimension_10_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_10_n, 0) + COALESCE(daily1.dimension_10_n, 0)) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND daily1.no_of_events_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.no_of_events_n, 0) + COALESCE(daily1.no_of_events_n, 0)) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT temp.id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(am.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dusr.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(am.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dusr.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.tr_msisdn_product_mapping mp on temp.metrics_key_v = mp.msisdn_v LEFT JOIN kpi.ms_actor_master am ON (am.actor_type_n = 7 and am.actor_id_v = temp.actor_key_v) LEFT JOIN kpi.ms_metrics_master met ON ( mp.prd_id_v = met.ext_metrics_id_v AND met.metrics_type_n = 13) LEFT JOIN kpi.ms_user_master dusr ON temp.source_key_v = dusr.operator_id_v WHERE temp.file_id_n = ? ) result where result.id_flag = 1 GROUP BY result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_daily_upload_metrics_aggr daily1 ON temp1.id_n = daily1.day_id_n AND temp1.actor_type_n = daily1.actor_type_n AND temp1.actor_id_n = daily1.actor_id_n AND temp1.event_type_n = daily1.event_type_n AND temp1.metrics_type_n = daily1.metrics_type_n AND temp1.metrics_id_n = daily1.metrics_id_n AND temp1.source_type_n = daily1.source_type_n AND temp1.source_id_n = daily1.source_id_n AND temp1.data_flag_n = daily1.data_flag_n AND temp1.instance_type_n = daily1.instance_type_n AND temp1.instance_id_n = daily1.instance_id_n
1080_MONTHLY_JOIN_QUERY_1=SELECT 1080 as interface_id_n, temp1.month_id_n AS id_n, monthly1.month_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND monthly1.dimension_1_n IS NULL) THEN NULL ELSE (COALESCE(temp1.dimension_1_n, 0) + COALESCE(monthly1.dimension_1_n, 0)) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND monthly1.dimension_2_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_2_n, 0) + COALESCE(monthly1.dimension_2_n, 0)) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND monthly1.dimension_3_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_3_n, 0) + COALESCE(monthly1.dimension_3_n, 0)) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND monthly1.dimension_4_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_4_n, 0) + COALESCE(monthly1.dimension_4_n, 0)) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND monthly1.dimension_5_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_5_n, 0) + COALESCE(monthly1.dimension_5_n, 0)) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND monthly1.dimension_6_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_6_n, 0) + COALESCE(monthly1.dimension_6_n, 0)) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND monthly1.dimension_7_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_7_n, 0) + COALESCE(monthly1.dimension_7_n, 0)) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND monthly1.dimension_8_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_8_n, 0) + COALESCE(monthly1.dimension_8_n, 0)) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND monthly1.dimension_9_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_9_n, 0) + COALESCE(monthly1.dimension_9_n, 0)) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND monthly1.dimension_10_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_10_n, 0) + COALESCE(monthly1.dimension_10_n, 0)) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND monthly1.no_of_events_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.no_of_events_n, 0) + COALESCE(monthly1.no_of_events_n, 0)) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT day_master.month_id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(am.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dusr.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(am.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dusr.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.tr_msisdn_product_mapping mp on temp.metrics_key_v = mp.msisdn_v LEFT JOIN kpi.ms_actor_master am ON (am.actor_type_n = 7 and am.actor_id_v = temp.actor_key_v) LEFT JOIN kpi.ms_metrics_master met ON ( mp.prd_id_v = met.ext_metrics_id_v AND met.metrics_type_n = 13) LEFT JOIN kpi.ms_user_master dusr ON temp.source_key_v = dusr.operator_id_v INNER JOIN kpi.ms_day_master AS day_master ON ( temp.id_n = day_master.day_id_n ) WHERE temp.file_id_n = ? and temp.status_flag_n = 0 ) result where result.id_flag = 1 GROUP BY result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_monthly_upload_metrics_aggr monthly1 ON temp1.month_id_n = monthly1.month_id_n AND temp1.actor_type_n = monthly1.actor_type_n AND temp1.actor_id_n = monthly1.actor_id_n AND temp1.event_type_n = monthly1.event_type_n AND temp1.metrics_type_n = monthly1.metrics_type_n AND temp1.metrics_id_n = monthly1.metrics_id_n AND temp1.source_type_n = monthly1.source_type_n AND temp1.source_id_n = monthly1.source_id_n AND temp1.data_flag_n = monthly1.data_flag_n AND temp1.instance_type_n = monthly1.instance_type_n AND temp1.instance_id_n = monthly1.instance_id_n
1081_DAILY_JOIN_QUERY_1=SELECT 1081 as interface_id_n, temp1.id_n, daily1.day_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND daily1.dimension_1_n IS NULL) THEN NULL ELSE ( COALESCE(temp1.dimension_1_n, 0) + COALESCE(daily1.dimension_1_n, 0) ) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND daily1.dimension_2_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_2_n, 0) + COALESCE(daily1.dimension_2_n, 0) ) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND daily1.dimension_3_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_3_n, 0) + COALESCE(daily1.dimension_3_n, 0) ) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND daily1.dimension_4_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_4_n, 0) + COALESCE(daily1.dimension_4_n, 0) ) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND daily1.dimension_5_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_5_n, 0) + COALESCE(daily1.dimension_5_n, 0) ) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND daily1.dimension_6_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_6_n, 0) + COALESCE(daily1.dimension_6_n, 0) ) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND daily1.dimension_7_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_7_n, 0) + COALESCE(daily1.dimension_7_n, 0) ) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND daily1.dimension_8_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_8_n, 0) + COALESCE(daily1.dimension_8_n, 0) ) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND daily1.dimension_9_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_9_n, 0) + COALESCE(daily1.dimension_9_n, 0) ) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND daily1.dimension_10_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_10_n, 0) + COALESCE(daily1.dimension_10_n, 0) ) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND daily1.no_of_events_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.no_of_events_n, 0) + COALESCE(daily1.no_of_events_n, 0) ) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT temp.id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(org.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, temp.metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dorg.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(org.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_direct_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(temp.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_direct_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dorg.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_direct_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_direct_aggr temp LEFT JOIN kpi.ms_org_master org ON temp.actor_key_v = org.ref_code_v LEFT JOIN kpi.ms_org_master dorg ON temp.source_key_v = dorg.ref_code_v WHERE temp.file_id_n = ? ) result where result.id_flag = 1 GROUP BY result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_daily_upload_metrics_aggr daily1 ON temp1.id_n = daily1.day_id_n AND temp1.actor_type_n = daily1.actor_type_n AND temp1.actor_id_n = daily1.actor_id_n AND temp1.event_type_n = daily1.event_type_n AND temp1.metrics_type_n = daily1.metrics_type_n AND temp1.metrics_id_n = daily1.metrics_id_n AND temp1.source_type_n = daily1.source_type_n AND temp1.source_id_n = daily1.source_id_n AND temp1.data_flag_n = daily1.data_flag_n AND temp1.instance_type_n = daily1.instance_type_n AND temp1.instance_id_n = daily1.instance_id_n
1081_MONTHLY_JOIN_QUERY_1=SELECT 1081 as interface_id_n, temp1.month_id_n AS id_n, monthly1.month_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND monthly1.dimension_1_n IS NULL) THEN NULL ELSE ( COALESCE(temp1.dimension_1_n, 0) + COALESCE(monthly1.dimension_1_n, 0) ) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND monthly1.dimension_2_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_2_n, 0) + COALESCE(monthly1.dimension_2_n, 0) ) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND monthly1.dimension_3_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_3_n, 0) + COALESCE(monthly1.dimension_3_n, 0) ) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND monthly1.dimension_4_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_4_n, 0) + COALESCE(monthly1.dimension_4_n, 0) ) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND monthly1.dimension_5_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_5_n, 0) + COALESCE(monthly1.dimension_5_n, 0) ) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND monthly1.dimension_6_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_6_n, 0) + COALESCE(monthly1.dimension_6_n, 0) ) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND monthly1.dimension_7_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_7_n, 0) + COALESCE(monthly1.dimension_7_n, 0) ) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND monthly1.dimension_8_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_8_n, 0) + COALESCE(monthly1.dimension_8_n, 0) ) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND monthly1.dimension_9_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_9_n, 0) + COALESCE(monthly1.dimension_9_n, 0) ) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND monthly1.dimension_10_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_10_n, 0) + COALESCE(monthly1.dimension_10_n, 0) ) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND monthly1.no_of_events_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.no_of_events_n, 0) + COALESCE(monthly1.no_of_events_n, 0) ) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT day_master.month_id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(org.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, temp.metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dorg.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(org.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_direct_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(temp.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_direct_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dorg.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_direct_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_direct_aggr temp LEFT JOIN kpi.ms_org_master org ON temp.actor_key_v = org.ref_code_v LEFT JOIN kpi.ms_org_master dorg ON temp.source_key_v = dorg.ref_code_v INNER JOIN kpi.ms_day_master AS day_master ON ( temp.id_n = day_master.day_id_n ) WHERE temp.file_id_n = ? and temp.status_flag_n = 0 ) result where result.id_flag = 1 GROUP BY result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_monthly_upload_metrics_aggr monthly1 ON temp1.month_id_n = monthly1.month_id_n AND temp1.actor_type_n = monthly1.actor_type_n AND temp1.actor_id_n = monthly1.actor_id_n AND temp1.event_type_n = monthly1.event_type_n AND temp1.metrics_type_n = monthly1.metrics_type_n AND temp1.metrics_id_n = monthly1.metrics_id_n AND temp1.source_type_n = monthly1.source_type_n AND temp1.source_id_n = monthly1.source_id_n AND temp1.data_flag_n = monthly1.data_flag_n AND temp1.instance_type_n = monthly1.instance_type_n AND temp1.instance_id_n = monthly1.instance_id_n

==============================================================================================================================
New 	queries.properties 1076-1081
==============================================================================================================================
1076_DAILY_JOIN_QUERY_1=SELECT 1076 as interface_id_n, temp1.id_n, daily1.day_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND daily1.dimension_1_n IS NULL) THEN NULL ELSE ( COALESCE(temp1.dimension_1_n, 0) + COALESCE(daily1.dimension_1_n, 0) ) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND daily1.dimension_2_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_2_n, 0) + COALESCE(daily1.dimension_2_n, 0) ) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND daily1.dimension_3_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_3_n, 0) + COALESCE(daily1.dimension_3_n, 0) ) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND daily1.dimension_4_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_4_n, 0) + COALESCE(daily1.dimension_4_n, 0) ) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND daily1.dimension_5_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_5_n, 0) + COALESCE(daily1.dimension_5_n, 0) ) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND daily1.dimension_6_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_6_n, 0) + COALESCE(daily1.dimension_6_n, 0) ) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND daily1.dimension_7_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_7_n, 0) + COALESCE(daily1.dimension_7_n, 0) ) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND daily1.dimension_8_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_8_n, 0) + COALESCE(daily1.dimension_8_n, 0) ) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND daily1.dimension_9_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_9_n, 0) + COALESCE(daily1.dimension_9_n, 0) ) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND daily1.dimension_10_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_10_n, 0) + COALESCE(daily1.dimension_10_n, 0) ) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND daily1.no_of_events_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.no_of_events_n, 0) + COALESCE(daily1.no_of_events_n, 0) ) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT temp.id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(nm.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dorg.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.instance_type_n), temp.instance_type_n) as instance_type_n, COALESCE(imet.metrics_id_n, 0) AS instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(nm.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dorg.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) WHEN temp.instance_key_v IS NOT NULL AND COALESCE(imet.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'instance_field%Instance mapping not found for instance_field : ' || temp.instance_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.ms_network_master nm ON temp.actor_key_v = nm.lacci_id_v LEFT JOIN kpi.ms_metrics_master met ON ( temp.metrics_key_v = met.ext_reference_id_v AND met.metrics_type_n = 30 ) LEFT JOIN kpi.ms_org_master dorg ON temp.source_key_v = dorg.ref_code_v LEFT JOIN kpi.ms_metrics_master imet ON ( temp.instance_key_v = imet.ext_reference_id_v AND imet.metrics_type_n = 38 ) WHERE temp.file_id_n = ? ) result where result.id_flag = 1 GROUP BY result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_daily_reload_seller_aggr daily1 ON temp1.id_n = daily1.day_id_n AND temp1.actor_type_n = daily1.actor_type_n AND temp1.actor_id_n = daily1.actor_id_n AND temp1.event_type_n = daily1.event_type_n AND temp1.metrics_type_n = daily1.metrics_type_n AND temp1.metrics_id_n = daily1.metrics_id_n AND temp1.source_type_n = daily1.source_type_n AND temp1.source_id_n = daily1.source_id_n AND temp1.data_flag_n = daily1.data_flag_n AND temp1.instance_type_n = daily1.instance_type_n AND temp1.instance_id_n = daily1.instance_id_n
1076_MONTHLY_JOIN_QUERY_1=SELECT 1076 as interface_id_n, temp1.month_id_n AS id_n, monthly1.month_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND monthly1.dimension_1_n IS NULL) THEN NULL ELSE ( COALESCE(temp1.dimension_1_n, 0) + COALESCE(monthly1.dimension_1_n, 0) ) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND monthly1.dimension_2_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_2_n, 0) + COALESCE(monthly1.dimension_2_n, 0) ) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND monthly1.dimension_3_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_3_n, 0) + COALESCE(monthly1.dimension_3_n, 0) ) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND monthly1.dimension_4_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_4_n, 0) + COALESCE(monthly1.dimension_4_n, 0) ) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND monthly1.dimension_5_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_5_n, 0) + COALESCE(monthly1.dimension_5_n, 0) ) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND monthly1.dimension_6_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_6_n, 0) + COALESCE(monthly1.dimension_6_n, 0) ) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND monthly1.dimension_7_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_7_n, 0) + COALESCE(monthly1.dimension_7_n, 0) ) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND monthly1.dimension_8_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_8_n, 0) + COALESCE(monthly1.dimension_8_n, 0) ) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND monthly1.dimension_9_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_9_n, 0) + COALESCE(monthly1.dimension_9_n, 0) ) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND monthly1.dimension_10_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_10_n, 0) + COALESCE(monthly1.dimension_10_n, 0) ) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND monthly1.no_of_events_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.no_of_events_n, 0) + COALESCE(monthly1.no_of_events_n, 0) ) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT day_master.month_id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(nm.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dorg.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.instance_type_n), temp.instance_type_n) as instance_type_n, COALESCE(imet.metrics_id_n, 0) AS instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(nm.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dorg.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) WHEN temp.instance_key_v IS NOT NULL AND COALESCE(imet.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'instance_field%Instance mapping not found for instance_field : ' || temp.instance_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.ms_network_master nm ON temp.actor_key_v = nm.lacci_id_v LEFT JOIN kpi.ms_metrics_master met ON ( temp.metrics_key_v = met.ext_reference_id_v AND met.metrics_type_n = 30 ) LEFT JOIN kpi.ms_org_master dorg ON temp.source_key_v = dorg.ref_code_v LEFT JOIN kpi.ms_metrics_master imet ON ( temp.instance_key_v = imet.ext_reference_id_v AND imet.metrics_type_n = 38 ) INNER JOIN kpi.ms_day_master AS day_master ON ( temp.id_n = day_master.day_id_n ) WHERE temp.file_id_n = ? and temp.status_flag_n = 0 ) result where result.id_flag = 1 GROUP BY result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_monthly_reload_seller_aggr monthly1 ON temp1.month_id_n = monthly1.month_id_n AND temp1.actor_type_n = monthly1.actor_type_n AND temp1.actor_id_n = monthly1.actor_id_n AND temp1.event_type_n = monthly1.event_type_n AND temp1.metrics_type_n = monthly1.metrics_type_n AND temp1.metrics_id_n = monthly1.metrics_id_n AND temp1.source_type_n = monthly1.source_type_n AND temp1.source_id_n = monthly1.source_id_n AND temp1.data_flag_n = monthly1.data_flag_n AND temp1.instance_type_n = monthly1.instance_type_n AND temp1.instance_id_n = monthly1.instance_id_n
1077_DAILY_JOIN_QUERY_1=SELECT 1077 as interface_id_n, temp1.id_n, daily1.day_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND daily1.dimension_1_n IS NULL) THEN NULL ELSE ( COALESCE(temp1.dimension_1_n, 0) + COALESCE(daily1.dimension_1_n, 0) ) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND daily1.dimension_2_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_2_n, 0) + COALESCE(daily1.dimension_2_n, 0) ) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND daily1.dimension_3_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_3_n, 0) + COALESCE(daily1.dimension_3_n, 0) ) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND daily1.dimension_4_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_4_n, 0) + COALESCE(daily1.dimension_4_n, 0) ) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND daily1.dimension_5_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_5_n, 0) + COALESCE(daily1.dimension_5_n, 0) ) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND daily1.dimension_6_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_6_n, 0) + COALESCE(daily1.dimension_6_n, 0) ) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND daily1.dimension_7_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_7_n, 0) + COALESCE(daily1.dimension_7_n, 0) ) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND daily1.dimension_8_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_8_n, 0) + COALESCE(daily1.dimension_8_n, 0) ) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND daily1.dimension_9_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_9_n, 0) + COALESCE(daily1.dimension_9_n, 0) ) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND daily1.dimension_10_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_10_n, 0) + COALESCE(daily1.dimension_10_n, 0) ) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND daily1.no_of_events_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.no_of_events_n, 0) + COALESCE(daily1.no_of_events_n, 0) ) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT temp.id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(nm.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, temp.source_type_n, temp.source_id_n, temp.data_flag_n, temp.instance_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.instance_type_n), temp.instance_type_n) as instance_type_n, COALESCE(imet.metrics_id_n, 0) AS instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(nm.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.instance_key_v IS NOT NULL AND COALESCE(imet.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'instance_field%Instance mapping not found for instance_field : ' || temp.instance_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.ms_network_master nm ON temp.actor_key_v = nm.lacci_id_v LEFT JOIN kpi.ms_metrics_master met ON ( temp.metrics_key_v = met.ext_reference_id_v AND met.metrics_type_n = 30 ) LEFT JOIN kpi.ms_metrics_master imet ON ( temp.instance_key_v = imet.ext_reference_id_v AND imet.metrics_type_n = 38 ) WHERE temp.file_id_n = ? ) result where result.id_flag = 1 GROUP BY result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_daily_reload_buyer_aggr daily1 ON temp1.id_n = daily1.day_id_n AND temp1.actor_type_n = daily1.actor_type_n AND temp1.actor_id_n = daily1.actor_id_n AND temp1.event_type_n = daily1.event_type_n AND temp1.metrics_type_n = daily1.metrics_type_n AND temp1.metrics_id_n = daily1.metrics_id_n AND temp1.source_type_n = daily1.source_type_n AND temp1.source_id_n = daily1.source_id_n AND temp1.data_flag_n = daily1.data_flag_n AND temp1.instance_type_n = daily1.instance_type_n AND temp1.instance_id_n = daily1.instance_id_n
1077_MONTHLY_JOIN_QUERY_1=SELECT 1077 as interface_id_n, temp1.month_id_n AS id_n, monthly1.month_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND monthly1.dimension_1_n IS NULL) THEN NULL ELSE ( COALESCE(temp1.dimension_1_n, 0) + COALESCE(monthly1.dimension_1_n, 0) ) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND monthly1.dimension_2_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_2_n, 0) + COALESCE(monthly1.dimension_2_n, 0) ) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND monthly1.dimension_3_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_3_n, 0) + COALESCE(monthly1.dimension_3_n, 0) ) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND monthly1.dimension_4_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_4_n, 0) + COALESCE(monthly1.dimension_4_n, 0) ) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND monthly1.dimension_5_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_5_n, 0) + COALESCE(monthly1.dimension_5_n, 0) ) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND monthly1.dimension_6_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_6_n, 0) + COALESCE(monthly1.dimension_6_n, 0) ) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND monthly1.dimension_7_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_7_n, 0) + COALESCE(monthly1.dimension_7_n, 0) ) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND monthly1.dimension_8_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_8_n, 0) + COALESCE(monthly1.dimension_8_n, 0) ) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND monthly1.dimension_9_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_9_n, 0) + COALESCE(monthly1.dimension_9_n, 0) ) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND monthly1.dimension_10_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_10_n, 0) + COALESCE(monthly1.dimension_10_n, 0) ) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND monthly1.no_of_events_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.no_of_events_n, 0) + COALESCE(monthly1.no_of_events_n, 0) ) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT day_master.month_id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(nm.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, temp.source_type_n, temp.source_id_n, temp.data_flag_n, temp.instance_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.instance_type_n), temp.instance_type_n) as instance_type_n, COALESCE(imet.metrics_id_n, 0) AS instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(nm.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.instance_key_v IS NOT NULL AND COALESCE(imet.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'instance_field%Instance mapping not found for instance_field : ' || temp.instance_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.ms_network_master nm ON temp.actor_key_v = nm.lacci_id_v LEFT JOIN kpi.ms_metrics_master met ON ( temp.metrics_key_v = met.ext_reference_id_v AND met.metrics_type_n = 30 ) LEFT JOIN kpi.ms_metrics_master imet ON ( temp.instance_key_v = imet.ext_reference_id_v AND imet.metrics_type_n = 38 ) INNER JOIN kpi.ms_day_master AS day_master ON ( temp.id_n = day_master.day_id_n ) WHERE temp.file_id_n = ? and temp.status_flag_n = 0 ) result where result.id_flag = 1 GROUP BY result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_monthly_reload_buyer_aggr monthly1 ON temp1.month_id_n = monthly1.month_id_n AND temp1.actor_type_n = monthly1.actor_type_n AND temp1.actor_id_n = monthly1.actor_id_n AND temp1.event_type_n = monthly1.event_type_n AND temp1.metrics_type_n = monthly1.metrics_type_n AND temp1.metrics_id_n = monthly1.metrics_id_n AND temp1.source_type_n = monthly1.source_type_n AND temp1.source_id_n = monthly1.source_id_n AND temp1.data_flag_n = monthly1.data_flag_n AND temp1.instance_type_n = monthly1.instance_type_n AND temp1.instance_id_n = monthly1.instance_id_n
1078_DAILY_JOIN_QUERY_1=SELECT 1078 as interface_id_n, temp1.id_n, daily1.day_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND daily1.dimension_1_n IS NULL) THEN NULL ELSE (COALESCE(temp1.dimension_1_n, 0) + COALESCE(daily1.dimension_1_n, 0)) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND daily1.dimension_2_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_2_n, 0) + COALESCE(daily1.dimension_2_n, 0)) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND daily1.dimension_3_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_3_n, 0) + COALESCE(daily1.dimension_3_n, 0)) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND daily1.dimension_4_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_4_n, 0) + COALESCE(daily1.dimension_4_n, 0)) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND daily1.dimension_5_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_5_n, 0) + COALESCE(daily1.dimension_5_n, 0)) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND daily1.dimension_6_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_6_n, 0) + COALESCE(daily1.dimension_6_n, 0)) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND daily1.dimension_7_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_7_n, 0) + COALESCE(daily1.dimension_7_n, 0)) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND daily1.dimension_8_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_8_n, 0) + COALESCE(daily1.dimension_8_n, 0)) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND daily1.dimension_9_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_9_n, 0) + COALESCE(daily1.dimension_9_n, 0)) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND daily1.dimension_10_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_10_n, 0) + COALESCE(daily1.dimension_10_n, 0)) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND daily1.no_of_events_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.no_of_events_n, 0) + COALESCE(daily1.no_of_events_n, 0)) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT temp.id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(am.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dusr.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(am.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dusr.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.tr_msisdn_product_mapping mp on temp.metrics_key_v = mp.msisdn_v LEFT JOIN kpi.ms_actor_master am ON (am.actor_type_n = 7 and am.actor_id_v = temp.actor_key_v) LEFT JOIN kpi.ms_metrics_master met ON ( mp.prd_id_v = met.ext_metrics_id_v AND met.metrics_type_n = 13) LEFT JOIN kpi.ms_user_master dusr ON temp.source_key_v = dusr.operator_id_v WHERE temp.file_id_n = ? ) result where result.id_flag = 1 GROUP BY result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_daily_usage_customer_aggr daily1 ON temp1.id_n = daily1.day_id_n AND temp1.actor_type_n = daily1.actor_type_n AND temp1.actor_id_n = daily1.actor_id_n AND temp1.event_type_n = daily1.event_type_n AND temp1.metrics_type_n = daily1.metrics_type_n AND temp1.metrics_id_n = daily1.metrics_id_n AND temp1.source_type_n = daily1.source_type_n AND temp1.source_id_n = daily1.source_id_n AND temp1.data_flag_n = daily1.data_flag_n AND temp1.instance_type_n = daily1.instance_type_n AND temp1.instance_id_n = daily1.instance_id_n
1078_MONTHLY_JOIN_QUERY_1=SELECT 1078 as interface_id_n, temp1.month_id_n AS id_n, monthly1.month_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND monthly1.dimension_1_n IS NULL) THEN NULL ELSE (COALESCE(temp1.dimension_1_n, 0) + COALESCE(monthly1.dimension_1_n, 0)) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND monthly1.dimension_2_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_2_n, 0) + COALESCE(monthly1.dimension_2_n, 0)) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND monthly1.dimension_3_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_3_n, 0) + COALESCE(monthly1.dimension_3_n, 0)) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND monthly1.dimension_4_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_4_n, 0) + COALESCE(monthly1.dimension_4_n, 0)) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND monthly1.dimension_5_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_5_n, 0) + COALESCE(monthly1.dimension_5_n, 0)) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND monthly1.dimension_6_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_6_n, 0) + COALESCE(monthly1.dimension_6_n, 0)) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND monthly1.dimension_7_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_7_n, 0) + COALESCE(monthly1.dimension_7_n, 0)) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND monthly1.dimension_8_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_8_n, 0) + COALESCE(monthly1.dimension_8_n, 0)) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND monthly1.dimension_9_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_9_n, 0) + COALESCE(monthly1.dimension_9_n, 0)) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND monthly1.dimension_10_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_10_n, 0) + COALESCE(monthly1.dimension_10_n, 0)) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND monthly1.no_of_events_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.no_of_events_n, 0) + COALESCE(monthly1.no_of_events_n, 0)) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT day_master.month_id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(am.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dusr.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(am.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dusr.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.tr_msisdn_product_mapping mp on temp.metrics_key_v = mp.msisdn_v LEFT JOIN kpi.ms_actor_master am ON (am.actor_type_n = 7 and am.actor_id_v = temp.actor_key_v) LEFT JOIN kpi.ms_metrics_master met ON ( mp.prd_id_v = met.ext_metrics_id_v AND met.metrics_type_n = 13) LEFT JOIN kpi.ms_user_master dusr ON temp.source_key_v = dusr.operator_id_v INNER JOIN kpi.ms_day_master AS day_master ON ( temp.id_n = day_master.day_id_n ) WHERE temp.file_id_n = ? and temp.status_flag_n = 0 ) result where result.id_flag = 1 GROUP BY result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_monthly_usage_customer_aggr monthly1 ON temp1.month_id_n = monthly1.month_id_n AND temp1.actor_type_n = monthly1.actor_type_n AND temp1.actor_id_n = monthly1.actor_id_n AND temp1.event_type_n = monthly1.event_type_n AND temp1.metrics_type_n = monthly1.metrics_type_n AND temp1.metrics_id_n = monthly1.metrics_id_n AND temp1.source_type_n = monthly1.source_type_n AND temp1.source_id_n = monthly1.source_id_n AND temp1.data_flag_n = monthly1.data_flag_n AND temp1.instance_type_n = monthly1.instance_type_n AND temp1.instance_id_n = monthly1.instance_id_n
1079_DAILY_JOIN_QUERY_1=SELECT 1079 as interface_id_n, temp1.id_n, daily1.day_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND daily1.dimension_1_n IS NULL) THEN NULL ELSE (COALESCE(temp1.dimension_1_n, 0) + COALESCE(daily1.dimension_1_n, 0)) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND daily1.dimension_2_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_2_n, 0) + COALESCE(daily1.dimension_2_n, 0)) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND daily1.dimension_3_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_3_n, 0) + COALESCE(daily1.dimension_3_n, 0)) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND daily1.dimension_4_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_4_n, 0) + COALESCE(daily1.dimension_4_n, 0)) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND daily1.dimension_5_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_5_n, 0) + COALESCE(daily1.dimension_5_n, 0)) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND daily1.dimension_6_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_6_n, 0) + COALESCE(daily1.dimension_6_n, 0)) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND daily1.dimension_7_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_7_n, 0) + COALESCE(daily1.dimension_7_n, 0)) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND daily1.dimension_8_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_8_n, 0) + COALESCE(daily1.dimension_8_n, 0)) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND daily1.dimension_9_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_9_n, 0) + COALESCE(daily1.dimension_9_n, 0)) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND daily1.dimension_10_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_10_n, 0) + COALESCE(daily1.dimension_10_n, 0)) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND daily1.no_of_events_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.no_of_events_n, 0) + COALESCE(daily1.no_of_events_n, 0)) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT temp.id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(am.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dusr.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(am.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dusr.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.tr_msisdn_product_mapping mp on temp.actor_key_v = mp.msisdn_v LEFT JOIN kpi.ms_actor_master am ON (am.actor_type_n = 7 and am.actor_id_v = mp.msisdn_v) LEFT JOIN kpi.ms_metrics_master met ON ( temp.metrics_key_v = met.metrics_name_v AND met.metrics_type_n = 13 AND status_n IN ( 1, 174 ) ) LEFT JOIN kpi.ms_user_master dusr ON temp.source_key_v = dusr.operator_id_v WHERE temp.file_id_n = ? ) result where result.id_flag = 1 GROUP BY result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_daily_addon_customer_aggr daily1 ON temp1.id_n = daily1.day_id_n AND temp1.actor_type_n = daily1.actor_type_n AND temp1.actor_id_n = daily1.actor_id_n AND temp1.event_type_n = daily1.event_type_n AND temp1.metrics_type_n = daily1.metrics_type_n AND temp1.metrics_id_n = daily1.metrics_id_n AND temp1.source_type_n = daily1.source_type_n AND temp1.source_id_n = daily1.source_id_n AND temp1.data_flag_n = daily1.data_flag_n AND temp1.instance_type_n = daily1.instance_type_n AND temp1.instance_id_n = daily1.instance_id_n
1079_MONTHLY_JOIN_QUERY_1=SELECT 1079 as interface_id_n, temp1.month_id_n AS id_n, monthly1.month_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND monthly1.dimension_1_n IS NULL) THEN NULL ELSE (COALESCE(temp1.dimension_1_n, 0) + COALESCE(monthly1.dimension_1_n, 0)) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND monthly1.dimension_2_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_2_n, 0) + COALESCE(monthly1.dimension_2_n, 0) ) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND monthly1.dimension_3_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_3_n, 0) + COALESCE(monthly1.dimension_3_n, 0) ) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND monthly1.dimension_4_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_4_n, 0) + COALESCE(monthly1.dimension_4_n, 0) ) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND monthly1.dimension_5_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_5_n, 0) + COALESCE(monthly1.dimension_5_n, 0) ) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND monthly1.dimension_6_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_6_n, 0) + COALESCE(monthly1.dimension_6_n, 0) ) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND monthly1.dimension_7_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_7_n, 0) + COALESCE(monthly1.dimension_7_n, 0) ) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND monthly1.dimension_8_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_8_n, 0) + COALESCE(monthly1.dimension_8_n, 0) ) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND monthly1.dimension_9_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_9_n, 0) + COALESCE(monthly1.dimension_9_n, 0) ) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND monthly1.dimension_10_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_10_n, 0) + COALESCE(monthly1.dimension_10_n, 0) ) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND monthly1.no_of_events_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.no_of_events_n, 0) + COALESCE(monthly1.no_of_events_n, 0) ) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT day_master.month_id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(am.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dusr.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(am.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dusr.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.tr_msisdn_product_mapping mp on temp.actor_key_v = mp.msisdn_v LEFT JOIN kpi.ms_actor_master am ON (am.actor_type_n = 7 and am.actor_id_v = mp.msisdn_v) LEFT JOIN kpi.ms_metrics_master met ON ( temp.metrics_key_v = met.metrics_name_v AND met.metrics_type_n = 13 AND status_n IN ( 1, 174 ) ) LEFT JOIN kpi.ms_user_master dusr ON temp.source_key_v = dusr.operator_id_v INNER JOIN kpi.ms_day_master AS day_master ON ( temp.id_n = day_master.day_id_n ) WHERE temp.file_id_n = ? and temp.status_flag_n = 0 ) result where result.id_flag = 1 GROUP BY result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_monthly_addon_customer_aggr monthly1 ON temp1.month_id_n = monthly1.month_id_n AND temp1.actor_type_n = monthly1.actor_type_n AND temp1.actor_id_n = monthly1.actor_id_n AND temp1.event_type_n = monthly1.event_type_n AND temp1.metrics_type_n = monthly1.metrics_type_n AND temp1.metrics_id_n = monthly1.metrics_id_n AND temp1.source_type_n = monthly1.source_type_n AND temp1.source_id_n = monthly1.source_id_n AND temp1.data_flag_n = monthly1.data_flag_n AND temp1.instance_type_n = monthly1.instance_type_n AND temp1.instance_id_n = monthly1.instance_id_n
1080_DAILY_JOIN_QUERY_1=SELECT 1080 as interface_id_n, temp1.id_n, daily1.day_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND daily1.dimension_1_n IS NULL) THEN NULL ELSE (COALESCE(temp1.dimension_1_n, 0) + COALESCE(daily1.dimension_1_n, 0)) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND daily1.dimension_2_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_2_n, 0) + COALESCE(daily1.dimension_2_n, 0)) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND daily1.dimension_3_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_3_n, 0) + COALESCE(daily1.dimension_3_n, 0)) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND daily1.dimension_4_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_4_n, 0) + COALESCE(daily1.dimension_4_n, 0)) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND daily1.dimension_5_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_5_n, 0) + COALESCE(daily1.dimension_5_n, 0)) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND daily1.dimension_6_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_6_n, 0) + COALESCE(daily1.dimension_6_n, 0)) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND daily1.dimension_7_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_7_n, 0) + COALESCE(daily1.dimension_7_n, 0)) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND daily1.dimension_8_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_8_n, 0) + COALESCE(daily1.dimension_8_n, 0)) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND daily1.dimension_9_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_9_n, 0) + COALESCE(daily1.dimension_9_n, 0)) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND daily1.dimension_10_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_10_n, 0) + COALESCE(daily1.dimension_10_n, 0)) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND daily1.no_of_events_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.no_of_events_n, 0) + COALESCE(daily1.no_of_events_n, 0)) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT temp.id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(am.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dusr.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(am.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dusr.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.tr_msisdn_product_mapping mp on temp.metrics_key_v = mp.msisdn_v LEFT JOIN kpi.ms_actor_master am ON (am.actor_type_n = 7 and am.actor_id_v = temp.actor_key_v) LEFT JOIN kpi.ms_metrics_master met ON ( mp.prd_id_v = met.ext_metrics_id_v AND met.metrics_type_n = 13) LEFT JOIN kpi.ms_user_master dusr ON temp.source_key_v = dusr.operator_id_v WHERE temp.file_id_n = ? ) result where result.id_flag = 1 GROUP BY result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_daily_reload_customer_aggr daily1 ON temp1.id_n = daily1.day_id_n AND temp1.actor_type_n = daily1.actor_type_n AND temp1.actor_id_n = daily1.actor_id_n AND temp1.event_type_n = daily1.event_type_n AND temp1.metrics_type_n = daily1.metrics_type_n AND temp1.metrics_id_n = daily1.metrics_id_n AND temp1.source_type_n = daily1.source_type_n AND temp1.source_id_n = daily1.source_id_n AND temp1.data_flag_n = daily1.data_flag_n AND temp1.instance_type_n = daily1.instance_type_n AND temp1.instance_id_n = daily1.instance_id_n
1080_MONTHLY_JOIN_QUERY_1=SELECT 1080 as interface_id_n, temp1.month_id_n AS id_n, monthly1.month_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND monthly1.dimension_1_n IS NULL) THEN NULL ELSE (COALESCE(temp1.dimension_1_n, 0) + COALESCE(monthly1.dimension_1_n, 0)) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND monthly1.dimension_2_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_2_n, 0) + COALESCE(monthly1.dimension_2_n, 0)) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND monthly1.dimension_3_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_3_n, 0) + COALESCE(monthly1.dimension_3_n, 0)) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND monthly1.dimension_4_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_4_n, 0) + COALESCE(monthly1.dimension_4_n, 0)) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND monthly1.dimension_5_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_5_n, 0) + COALESCE(monthly1.dimension_5_n, 0)) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND monthly1.dimension_6_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_6_n, 0) + COALESCE(monthly1.dimension_6_n, 0)) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND monthly1.dimension_7_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_7_n, 0) + COALESCE(monthly1.dimension_7_n, 0)) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND monthly1.dimension_8_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_8_n, 0) + COALESCE(monthly1.dimension_8_n, 0)) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND monthly1.dimension_9_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_9_n, 0) + COALESCE(monthly1.dimension_9_n, 0)) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND monthly1.dimension_10_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.dimension_10_n, 0) + COALESCE(monthly1.dimension_10_n, 0)) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND monthly1.no_of_events_n IS NULL ) THEN NULL ELSE (COALESCE(temp1.no_of_events_n, 0) + COALESCE(monthly1.no_of_events_n, 0)) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT day_master.month_id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(am.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, COALESCE(met.metrics_id_n, 0) AS metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dusr.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(am.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(met.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dusr.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_aggr temp LEFT JOIN kpi.tr_msisdn_product_mapping mp on temp.metrics_key_v = mp.msisdn_v LEFT JOIN kpi.ms_actor_master am ON (am.actor_type_n = 7 and am.actor_id_v = temp.actor_key_v) LEFT JOIN kpi.ms_metrics_master met ON ( mp.prd_id_v = met.ext_metrics_id_v AND met.metrics_type_n = 13) LEFT JOIN kpi.ms_user_master dusr ON temp.source_key_v = dusr.operator_id_v INNER JOIN kpi.ms_day_master AS day_master ON ( temp.id_n = day_master.day_id_n ) WHERE temp.file_id_n = ? and temp.status_flag_n = 0 ) result where result.id_flag = 1 GROUP BY result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_monthly_reload_customer_aggr monthly1 ON temp1.month_id_n = monthly1.month_id_n AND temp1.actor_type_n = monthly1.actor_type_n AND temp1.actor_id_n = monthly1.actor_id_n AND temp1.event_type_n = monthly1.event_type_n AND temp1.metrics_type_n = monthly1.metrics_type_n AND temp1.metrics_id_n = monthly1.metrics_id_n AND temp1.source_type_n = monthly1.source_type_n AND temp1.source_id_n = monthly1.source_id_n AND temp1.data_flag_n = monthly1.data_flag_n AND temp1.instance_type_n = monthly1.instance_type_n AND temp1.instance_id_n = monthly1.instance_id_n
1081_DAILY_JOIN_QUERY_1=SELECT 1081 as interface_id_n, temp1.id_n, daily1.day_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND daily1.dimension_1_n IS NULL) THEN NULL ELSE ( COALESCE(temp1.dimension_1_n, 0) + COALESCE(daily1.dimension_1_n, 0) ) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND daily1.dimension_2_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_2_n, 0) + COALESCE(daily1.dimension_2_n, 0) ) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND daily1.dimension_3_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_3_n, 0) + COALESCE(daily1.dimension_3_n, 0) ) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND daily1.dimension_4_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_4_n, 0) + COALESCE(daily1.dimension_4_n, 0) ) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND daily1.dimension_5_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_5_n, 0) + COALESCE(daily1.dimension_5_n, 0) ) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND daily1.dimension_6_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_6_n, 0) + COALESCE(daily1.dimension_6_n, 0) ) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND daily1.dimension_7_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_7_n, 0) + COALESCE(daily1.dimension_7_n, 0) ) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND daily1.dimension_8_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_8_n, 0) + COALESCE(daily1.dimension_8_n, 0) ) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND daily1.dimension_9_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_9_n, 0) + COALESCE(daily1.dimension_9_n, 0) ) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND daily1.dimension_10_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_10_n, 0) + COALESCE(daily1.dimension_10_n, 0) ) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND daily1.no_of_events_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.no_of_events_n, 0) + COALESCE(daily1.no_of_events_n, 0) ) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT temp.id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(org.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, temp.metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dorg.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(org.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_direct_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(temp.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_direct_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dorg.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_direct_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_direct_aggr temp LEFT JOIN kpi.ms_org_master org ON temp.actor_key_v = org.ref_code_v LEFT JOIN kpi.ms_org_master dorg ON temp.source_key_v = dorg.ref_code_v WHERE temp.file_id_n = ? ) result where result.id_flag = 1 GROUP BY result.id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_daily_reload_sellinout_aggr daily1 ON temp1.id_n = daily1.day_id_n AND temp1.actor_type_n = daily1.actor_type_n AND temp1.actor_id_n = daily1.actor_id_n AND temp1.event_type_n = daily1.event_type_n AND temp1.metrics_type_n = daily1.metrics_type_n AND temp1.metrics_id_n = daily1.metrics_id_n AND temp1.source_type_n = daily1.source_type_n AND temp1.source_id_n = daily1.source_id_n AND temp1.data_flag_n = daily1.data_flag_n AND temp1.instance_type_n = daily1.instance_type_n AND temp1.instance_id_n = daily1.instance_id_n
1081_MONTHLY_JOIN_QUERY_1=SELECT 1081 as interface_id_n, temp1.month_id_n AS id_n, monthly1.month_id_n, temp1.actor_type_n, temp1.actor_id_n, temp1.event_type_n, temp1.metrics_type_n, temp1.metrics_id_n, CASE WHEN( temp1.dimension_1_n IS NULL AND monthly1.dimension_1_n IS NULL) THEN NULL ELSE ( COALESCE(temp1.dimension_1_n, 0) + COALESCE(monthly1.dimension_1_n, 0) ) END AS dimension_1_n, CASE WHEN ( temp1.dimension_2_n IS NULL AND monthly1.dimension_2_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_2_n, 0) + COALESCE(monthly1.dimension_2_n, 0) ) END AS dimension_2_n, CASE WHEN ( temp1.dimension_3_n IS NULL AND monthly1.dimension_3_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_3_n, 0) + COALESCE(monthly1.dimension_3_n, 0) ) END AS dimension_3_n, CASE WHEN ( temp1.dimension_4_n IS NULL AND monthly1.dimension_4_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_4_n, 0) + COALESCE(monthly1.dimension_4_n, 0) ) END AS dimension_4_n, CASE WHEN ( temp1.dimension_5_n IS NULL AND monthly1.dimension_5_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_5_n, 0) + COALESCE(monthly1.dimension_5_n, 0) ) END AS dimension_5_n, CASE WHEN ( temp1.dimension_6_n IS NULL AND monthly1.dimension_6_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_6_n, 0) + COALESCE(monthly1.dimension_6_n, 0) ) END AS dimension_6_n, CASE WHEN ( temp1.dimension_7_n IS NULL AND monthly1.dimension_7_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_7_n, 0) + COALESCE(monthly1.dimension_7_n, 0) ) END AS dimension_7_n, CASE WHEN ( temp1.dimension_8_n IS NULL AND monthly1.dimension_8_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_8_n, 0) + COALESCE(monthly1.dimension_8_n, 0) ) END AS dimension_8_n, CASE WHEN ( temp1.dimension_9_n IS NULL AND monthly1.dimension_9_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_9_n, 0) + COALESCE(monthly1.dimension_9_n, 0) ) END AS dimension_9_n, CASE WHEN ( temp1.dimension_10_n IS NULL AND monthly1.dimension_10_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.dimension_10_n, 0) + COALESCE(monthly1.dimension_10_n, 0) ) END AS dimension_10_n, CASE WHEN ( temp1.no_of_events_n IS NULL AND monthly1.no_of_events_n IS NULL ) THEN NULL ELSE ( COALESCE(temp1.no_of_events_n, 0) + COALESCE(monthly1.no_of_events_n, 0) ) END AS no_of_events_n, temp1.source_type_n, temp1.source_id_n, temp1.data_flag_n, temp1.instance_type_n, temp1.instance_id_n FROM ( SELECT result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, Sum(result.dimension_1_n) AS dimension_1_n, Sum(result.dimension_2_n) AS dimension_2_n, Sum(result.dimension_3_n) AS dimension_3_n, Sum(result.dimension_4_n) dimension_4_n, Sum(result.dimension_5_n) AS dimension_5_n, Sum(result.dimension_6_n) AS dimension_6_n, Sum(result.dimension_7_n) AS dimension_7_n, Sum(result.dimension_8_n) AS dimension_8_n, Sum(result.dimension_9_n) AS dimension_9_n, Sum(result.dimension_10_n) AS dimension_10_n, Sum(result.no_of_events_n) AS no_of_events_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n FROM ( SELECT day_master.month_id_n, temp.actor_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.actor_type_n), temp.actor_type_n) as actor_type_n, COALESCE(org.aggregation_id_n, 0) AS actor_id_n, temp.event_type_n, temp.metrics_key_v, COALESCE(( select reference_type_n from kpi.ms_metrics_lookup_master where metrics_type_n = temp.metrics_type_n), temp.metrics_type_n) as metrics_type_n, temp.metrics_id_n, temp.dimension_1_n, temp.dimension_2_n, temp.dimension_3_n, temp.dimension_4_n, temp.dimension_5_n, temp.dimension_6_n, temp.dimension_7_n, temp.dimension_8_n, temp.dimension_9_n, temp.dimension_10_n, temp.no_of_events_n, temp.source_key_v, COALESCE(( select reference_type_n from kpi.ms_actor_lookup_master where actor_type_n = temp.source_type_n), temp.source_type_n) as source_type_n, COALESCE(dorg.aggregation_id_n, 0) AS source_id_n, temp.data_flag_n, temp.instance_key_v, temp.instance_type_n, temp.instance_id_n, temp.file_id_n, CASE WHEN temp.actor_key_v IS NOT NULL AND COALESCE(org.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_direct_aggr', temp.temp_id_n, 'actor_field%Actor mapping not found for actor_field : ' || temp.actor_key_v) WHEN temp.metrics_key_v IS NOT NULL AND COALESCE(temp.metrics_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_direct_aggr', temp.temp_id_n, 'metric_field%Metric mapping not found for metric_field : ' || temp.metrics_key_v) WHEN temp.source_key_v IS NOT NULL AND COALESCE(dorg.aggregation_id_n, 0) = 0 THEN kpi.update_analytics_failed_row('tr_temp_upload_metrics_direct_aggr', temp.temp_id_n, 'source_field%Source mapping not found for source_field : ' || temp.source_key_v) ELSE 1 END AS id_flag FROM kpi.tr_temp_upload_metrics_direct_aggr temp LEFT JOIN kpi.ms_org_master org ON temp.actor_key_v = org.ref_code_v LEFT JOIN kpi.ms_org_master dorg ON temp.source_key_v = dorg.ref_code_v INNER JOIN kpi.ms_day_master AS day_master ON ( temp.id_n = day_master.day_id_n ) WHERE temp.file_id_n = ? and temp.status_flag_n = 0 ) result where result.id_flag = 1 GROUP BY result.month_id_n, result.actor_type_n, result.actor_id_n, result.event_type_n, result.metrics_type_n, result.metrics_id_n, result.source_type_n, result.source_id_n, result.data_flag_n, result.instance_type_n, result.instance_id_n, result.file_id_n ) temp1 LEFT JOIN kpi.tr_monthly_reload_sellinout_aggr monthly1 ON temp1.month_id_n = monthly1.month_id_n AND temp1.actor_type_n = monthly1.actor_type_n AND temp1.actor_id_n = monthly1.actor_id_n AND temp1.event_type_n = monthly1.event_type_n AND temp1.metrics_type_n = monthly1.metrics_type_n AND temp1.metrics_id_n = monthly1.metrics_id_n AND temp1.source_type_n = monthly1.source_type_n AND temp1.source_id_n = monthly1.source_id_n AND temp1.data_flag_n = monthly1.data_flag_n AND temp1.instance_type_n = monthly1.instance_type_n AND temp1.instance_id_n = monthly1.instance_id_n
==============================================================================================================================



























